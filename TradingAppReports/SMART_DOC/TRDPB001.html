<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>TRDPB001</title>    <style>        html,        body {            margin: 0;            padding: 0;            height: 100%;            border: 0;            display: flex;            flex-direction: column;        }        .container {            display: flex;            flex: 1;        }        .sidebar {            width: 20%;            background-color: #f4f4f4;            padding: 10px;            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);            text-align: left;            box-sizing: border-box;	    overflow-y: auto;            font-family: 'Consolas', monospace;        }        .sidebar button {            width: 100%;            padding: 10px;            margin: 5px 0;            border: none;            background-color: #282828;            color: #33FF33;            cursor: pointer;            font-size: 16px;            text-align: left;            font-family: 'Consolas', monospace;        }        .sidebar button:hover {            background-color: black;        }        .sidebar button.active {            background-color: #33FF33;            color: #282828;            font-weight: bold;        }        .content {            flex: 1;            padding: 10px;            overflow-y: auto;        }        .content-item {            display: none;        }        .content-item.active {            display: block;        }        .codes {            font-weight: bold;            font-size: 18px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            line-height: 1.6;        }        .explain {            border: 1px solid #bbb;            margin: 10px;            padding: 10px;            justify-content: center;            border-radius: 10px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;        }        .code2 {            background-color: #282828;            color: #33FF33;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: 18px;            font-weight: bold;            border-style: solid;            line-height: 1.6;        }        .bold-content {            color: #33FF33;            font-size: 18px;            font-weight: 900;            line-height: 1.5;            font-family: 'Consolas', monospace;            background-color: black;            padding: 0px;            /* margin: 20px; */        }        .cfq {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: 18px;            line-height: 1.6;        }        .cfqs {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            line-height: 1.6;            font-size: 18px;        }        .llm {            margin-top: 10px;            color: #fff;            --tw-bg-opacity: 1;            background-color: white;            color: black;            font-family: 'Barlow';            font-size: 18px;            line-height: 1.6;        }        .para {            margin-top: 10px;            color: black;            --tw-bg-opacity: 1;            background-color: white;            font-family: 'Barlow';            font-weight: bold;            font-size: 18px;            line-height: 1.6;        }        .explains {            background-color: white;        }        .main-content {            display: flex;            flex: 1;            overflow-y: hidden;            font-family: 'Consolas', monospace;            background-color: white;            min-height: 80vh;        }        .indent-container {            margin-left: 20px;        }        .file-name {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-weight: bold;            font-size: large;            padding: 10px;            background-color: #f4f4f4;            border-bottom: 2px solid #ccc;            margin-bottom: 10px;        }        .file-content {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: large;           position: absolute;           left: 50%;           font-size: 18px;           transform: translateX(-50%);        }        .weight-text {            font-size: 18px;        }                .footer {            background-color: #000;            color: #fff;            padding: 2px;            padding-left: 20px;            font-size: 16px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;        }        .footer-content {            display: flex;            justify-content: space-between;            align-items: center;        }        .footer-content img {            width: 160px;            height: auto;        }        .footer-content p{            padding-right: 20px;            font-size: 18px;        }        .header {            background-color: rgb(11, 78, 221);            color: #fff;            text-align: left;            display: flex;            flex-wrap: wrap;            align-items: center;            justify-content: space-between;            padding: 10px 20px;            font-size: 4vw;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            height: auto;        }        .header img {            flex-shrink: 0;            width: 10vw;            height: auto;            margin-right: 25px;            padding-bottom: 8px;        }        .header span {            flex-grow: 1;            font-size: 1.5vw;        }        @media screen and (max-width: 768px) {            .header{                font-size: 5vw;                padding: 10px 20px;                flex-direction: column;                align-items: flex-start;            }            .header img {                width: 20vw;                margin-right: 15px;            }            .header span {                font-size: 4vw;            }        }    </style></head><body>        <!-- smart-doc header -->	    <div class="main-content">        <div class="sidebar" id="sidebar">            <button onclick="showContent('contentProcDiv', this)" class="active">PROCEDURE DIVISION</button>            <div class="indent-container">				<button onclick="showContent('content0', this)">0000-MAINLINE</button>				<button onclick="showContent('content1', this)">1000-TRADE-SETTLEMENT</button>				<button onclick="showContent('content2', this)">2000-ACCOUNTING</button>				<button onclick="showContent('content3', this)">2001-SAC-BOOKING</button>				<button onclick="showContent('content4', this)">2002-MAC-BOOKING</button>				<button onclick="showContent('content5', this)">5000-READ-FROM-STLMT-QUEUE</button>				<button onclick="showContent('content6', this)">8000-UPDATE-ORDER</button>				<button onclick="showContent('content7', this)">9000-REPORT-EXCEPTION</button>				<button onclick="showContent('content8', this)">8001-LOG-SUMMARY</button>            </div>        </div>        <div class="content" id="content"><div id="content0" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet implements a process for handling currency validation and trade settlement logging. Initially, it checks if the currency is valid; if not, it sets an exception flag and logs an error message. It ensures a minimum check frequency and initializes a log for trade transactions. The current date and time are captured for logging purposes. The code then retrieves trade data from a database based on the specified currency. If the SQL operation fails, it logs the error. A loop processes trade settlements until a stop condition is met. Finally, it attempts to insert a log entry into the database, handling potential duplicate entries by updating existing records if necessary. The process concludes with a commit operation to finalize changes, ensuring data integrity. Overall, the code effectively manages trade settlements while incorporating error handling and logging mechanisms.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 20</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; Procedure Division</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; LK-CHKP-FREQUENCY</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; VALID-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; STQ-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; 88-STOP-SETTLEMENT</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-SETTLEMENT-SWITCH</div>        			<div class="cfqs">&emsp;&larr; LOG-TRANSACTION</div>        			<div class="cfqs">&emsp;&larr; WS-CURRTIME</div>        			<div class="cfqs">&emsp;&larr; WS-CURRDATE</div>        			<div class="cfqs">&emsp;&larr; SYSTEM-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; LOG-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; 88-CONTINUE-SETTLEMENT</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-TRADE-COUNT</div>        			<div class="cfqs">&emsp;&larr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; LK-CHKP-FREQUENCY</div>        			<div class="cfqs">&emsp;&larr; LOG-START-TS</div>        			<div class="cfqs">&emsp;&larr; DCLTBTRDLOG</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; LOG-END-TS</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">IF VALID-CURRENCY THEN</div>	<div class="cfq">If condition (VALID-CURRENCY) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET SYSTEM-EXCEPTION TO TRUE</div>	<div class="cfq">set variable SYSTEM-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING LK-CURRENCY ' : ' 'Currency parameter passed is invalid' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of variable LK-CURRENCY ,  value of String literal (' ) ,  value of String literal ('Currency parameter passed is invalid') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">IF LK-CHKP-FREQUENCY < 100 THEN</div>	<div class="cfq">If condition (LK-CHKP-FREQUENCY < 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE 100 TO LK-CHKP-FREQUENCY</div>	<div class="cfq">initialize variable LK-CHKP-FREQUENCY with 100</div></div></div><div class="explain">	<div class="bold-content">INITIALIZE DCLTBTRDLOG</div>	<div class="cfq">initialize the variable DCLTBTRDLOG with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE DCLTBTRDLOG</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">MOVE 'SETTLEMENT' TO LOG-TRANSACTION</div>	<div class="cfq">initialize variable LOG-TRANSACTION with 'SETTLEMENT'</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRDATE FROM DATE YYYYMMDD</div>	<div class="cfq">copy current system date using format YYYYMMDD into variable WS-CURRDATE</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRTIME FROM TIME</div>	<div class="cfq">copy current system time  into variable WS-CURRTIME</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO LOG-START-TS</div>	<div class="cfq">initialize variable LOG-START-TS with SPACE</div></div><div class="explain">	<div class="bold-content">STRING WS-CURRDATE (1 : 4) '-' WS-CURRDATE (5 : 2) '-' WS-CURRDATE (7 : 2) ' ' WS-CURRTIME (1 : 2) ':' WS-CURRTIME (3 : 2) ':' WS-CURRTIME (5 : 2) DELIMITED BY SIZE INTO LOG-START-TS END-STRING</div>	<div class="cfq">Concatenates  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal (' ') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) and stores the final result into variable LOG-START-TS.</div></div><div class="explain">	<div class="bold-content">MOVE LK-CURRENCY TO STQ-CURRENCY</div>	<div class="cfq">copy variable LK-CURRENCY to variable STQ-CURRENCY</div></div><div class="explain">	<div class="bold-content">SET 88-CONTINUE-SETTLEMENT TO TRUE</div>	<div class="cfq">set variable 88-CONTINUE-SETTLEMENT to true</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp; STQ_ID ,STQ_TRADE_DATA <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSTQ <br>WHERE <br>&nbsp;&nbsp;&nbsp;STQ_CURRENCY      = :STQ-CURRENCY <br>ORDER BY BY <br>&nbsp;&nbsp;&nbsp;STQ_CURRENCY ASC, STQ_ID  ASC </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDSTQ table by using ORDER BY column values in ascending </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Open SETTLEMENT_QUEUE Cursor failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Open SETTLEMENT_QUEUE Cursor failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-TRADE-COUNT</div>	<div class="cfq">initialize variable WS-TRADE-COUNT with 0</div></div><div class="explain">	<div class="bold-content">PERFORM 1000-TRADE-SETTLEMENT THRU 1000-EXIT UNTIL 88-STOP-SETTLEMENT</div>	<div class="cfq">execute paragraph 1000-TRADE-SETTLEMENT in a loop until variable 88-STOP-SETTLEMENT is true</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRDATE FROM DATE YYYYMMDD</div>	<div class="cfq">copy current system date using format YYYYMMDD into variable WS-CURRDATE</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRTIME FROM TIME</div>	<div class="cfq">copy current system time  into variable WS-CURRTIME</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO LOG-END-TS</div>	<div class="cfq">initialize variable LOG-END-TS with SPACE</div></div><div class="explain">	<div class="bold-content">STRING WS-CURRDATE (1 : 4) '-' WS-CURRDATE (5 : 2) '-' WS-CURRDATE (7 : 2) ' ' WS-CURRTIME (1 : 2) ':' WS-CURRTIME (3 : 2) ':' WS-CURRTIME (5 : 2) DELIMITED BY SIZE INTO LOG-END-TS END-STRING</div>	<div class="cfq">Concatenates  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal (' ') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) and stores the final result into variable LOG-END-TS.</div></div><div class="explain">	<div class="bold-content">INSERT INTO INTO <br>&nbsp;&nbsp;&nbsp;TBTRDLOG <br>VALUES <br>&nbsp;&nbsp;&nbsp;( :LOG-TRANSACTION ,:LOG-CURRENCY ,:LOG-START-TS ,:LOG-END-TS ) </div>	<div class="cfq">execute a sql INSERT statement using cursor INSERT </div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SQLCODE = 0</div>	<div class="cfq">when SQLCODE is 0</div></div><div class="explain">	<div class="bold-content">WHEN SQLCODE = -803</div>	<div class="cfq">when SQLCODE is -803</div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDLOG <br>SET <br>&nbsp;&nbsp;&nbsp;LOG_END_TS = :LOG-END-TS <br>WHERE <br>&nbsp;&nbsp;&nbsp;LOG_TRANSACTION = :LOG-TRANSACTION AND LOG_CURRENCY    = :LOG-CURRENCY </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'LOG Update Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('LOG Update Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'LOG Insert Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('LOG Insert Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">COMMIT <br>&nbsp;&nbsp;&nbsp;</div>	<div class="cfq">execute a sql COMMIT statement </div></div><div class="explain">	<div class="bold-content">GOBACK</div>	<div class="cfq">returns control to the caller but the parent process continues to execute</div></div></div></div></div><div id="content1" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 1000-TRADE-SETTLEMENT is responsible for managing trade settlements. It begins by incrementing the `WS-TRADE-COUNT` variable by 1. Next, it calls the `5000-READ-FROM-STLMT-QUEUE` paragraph to process trade data. If the condition `88-CONTINUE-SETTLEMENT` is true, it proceeds to execute the `2000-ACCOUNTING` paragraph, which likely handles financial calculations or updates. Furthermore, if the `WS-TRADE-COUNT` reaches or exceeds the threshold defined by `LK-CHKP-FREQUENCY`, a SQL COMMIT statement is executed to finalize the transactions, and `WS-TRADE-COUNT` is reset to 0. This code effectively tracks and processes trade settlements, ensuring that transactions are committed at specified intervals.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 4</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 0000-MAINLINE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; 88-CONTINUE-SETTLEMENT</div>        			<div class="cfqs">&emsp;&rarr; WS-TRADE-COUNT</div>        			<div class="cfqs">&emsp;&rarr; WS-SETTLEMENT-SWITCH</div>        			<div class="cfqs">&emsp;&rarr; LK-CHKP-FREQUENCY</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-TRADE-COUNT</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">ADD 1 TO WS-TRADE-COUNT</div>	<div class="cfq">increment variable WS-TRADE-COUNT by 1</div></div><div class="explain">	<div class="bold-content">PERFORM 5000-READ-FROM-STLMT-QUEUE THRU 5000-EXIT</div>	<div class="cfq">execute paragraph 5000-READ-FROM-STLMT-QUEUE</div></div><div class="explain">	<div class="bold-content">IF 88-CONTINUE-SETTLEMENT</div>	<div class="cfq">If condition (88-CONTINUE-SETTLEMENT) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 2000-ACCOUNTING THRU 2000-EXIT</div>	<div class="cfq">execute paragraph 2000-ACCOUNTING</div></div><div class="explain">	<div class="bold-content">IF WS-TRADE-COUNT >= LK-CHKP-FREQUENCY</div>	<div class="cfq">If condition (WS-TRADE-COUNT >= LK-CHKP-FREQUENCY) is true, then do the following: </div><div class="explain">	<div class="bold-content">COMMIT <br>&nbsp;&nbsp;&nbsp;</div>	<div class="cfq">execute a sql COMMIT statement </div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-TRADE-COUNT</div>	<div class="cfq">initialize variable WS-TRADE-COUNT with 0</div></div></div></div></div><div id="content2" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the 2000-ACCOUNTING paragraph manages trade settlement processes. It begins by executing the 2001-SAC-BOOKING paragraph. If the trade SAC booking is successful (indicated by the condition TRD-SAC-BOOKING-DONE), it proceeds to execute the 2002-MAC-BOOKING paragraph. If this second booking is also successful (TRD-MAC-BOOKING-DONE), it sets a variable, SETTLED, to true, indicating a successful settlement.If the MAC booking fails, the code sets a REJECTED flag to true and transfers various trade-related data (like order status, currency, exchange, order ID, and FIGI) to corresponding order variables. It then updates the order status twice, first marking it as a buy ('B') and then as a sell ('S'), by calling the 8000-UPDATE-ORDER paragraph. This structure ensures proper handling of trade settlements and rejections.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 3</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-TRADE-SETTLEMENT</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; TRD-SAC-BOOKING-DONE</div>        			<div class="cfqs">&emsp;&rarr; TRD-MAC-BOOKING-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SETTLED</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; REJECTED</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>	</div><div class="explain">	<div class="bold-content">PERFORM 2001-SAC-BOOKING THRU 2001-EXIT</div>	<div class="cfq">execute paragraph 2001-SAC-BOOKING</div></div><div class="explain">	<div class="bold-content">IF TRD-SAC-BOOKING-DONE</div>	<div class="cfq">If condition (TRD-SAC-BOOKING-DONE) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 2002-MAC-BOOKING THRU 2002-EXIT</div>	<div class="cfq">execute paragraph 2002-MAC-BOOKING</div></div></div><div class="explain">	<div class="bold-content">IF TRD-MAC-BOOKING-DONE</div>	<div class="cfq">If condition (TRD-MAC-BOOKING-DONE) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET SETTLED TO TRUE</div>	<div class="cfq">set variable SETTLED to true</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET REJECTED TO TRUE</div>	<div class="cfq">set variable REJECTED to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div></div><div id="content3" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 2001-SAC-BOOKING is designed to handle the outcome of a trade booking process. It begins by invoking a subprogram (WS-SAC-BOOKING) with the parameter TRD-ORDER-PAIR. If the trade booking is successful (indicated by the condition TRD-SAC-BOOKING-DONE being true), the program proceeds without any further action. However, if the booking fails, the code sets a flag (DATA-EXCEPTION) to true, indicating an error. It then transfers the trade order ID (TRD-ORDER-ID) to a workspace variable (WS-TRADEID) and initializes another variable (WS-EXCEPTION) to hold an error message. This message concatenates the trade ID with a rejection reason, stating that security bookings failed. Finally, the program calls a reporting routine (9000-REPORT-EXCEPTION) to handle the exception. Overall, this code effectively manages trade booking outcomes and reports errors when necessary.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 3</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 2000-ACCOUNTING</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-SAC-BOOKING-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-TRADEID</div>	</div><div class="explain">	<div class="bold-content">CALL WS-SAC-BOOKING USING TRD-ORDER-PAIR END-CALL</div>	<div class="cfq">invoke a program using variable WS-SAC-BOOKING, the actual program name is 'TRDPB002' using parameter variable TRD-ORDER-PAIR</div></div><div class="explain">	<div class="bold-content">IF TRD-SAC-BOOKING-DONE</div>	<div class="cfq">If condition (TRD-SAC-BOOKING-DONE) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO WS-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Security Bookings Failed' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div id="content4" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 2002-MAC-BOOKING is responsible for handling the outcome of a trade booking process. It begins by invoking a subprogram (WS-MAC-BOOKING) with the parameter TRD-ORDER-PAIR. If the trade booking is successful (indicated by the condition TRD-MAC-BOOKING-DONE being true), the program proceeds without any action. However, if the booking fails, it sets a flag (DATA-EXCEPTION) to true, indicating an error. The code then transfers the trade order ID (TRD-ORDER-ID) to a working variable (WS-TRADEID) and initializes another variable (WS-EXCEPTION) to hold an error message. It constructs a detailed rejection message that includes the trade ID and a reason for the failure, storing this message in WS-EXCEPTION. Finally, it calls another paragraph (9000-REPORT-EXCEPTION) to handle the reporting of this exception.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 3</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 2000-ACCOUNTING</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-MAC-BOOKING-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-TRADEID</div>	</div><div class="explain">	<div class="bold-content">CALL WS-MAC-BOOKING USING TRD-ORDER-PAIR END-CALL</div>	<div class="cfq">invoke a program using variable WS-MAC-BOOKING, the actual program name is 'TRDPB003' using parameter variable TRD-ORDER-PAIR</div></div><div class="explain">	<div class="bold-content">IF TRD-MAC-BOOKING-DONE</div>	<div class="cfq">If condition (TRD-MAC-BOOKING-DONE) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO WS-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Money Bookings Failed' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div id="content5" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5000-READ-FROM-STLMT-QUEUE is designed to manage trade settlement data from a queue. It begins by executing a SQL FETCH statement to retrieve data from the `SETTLEMENT_QUEUE` cursor into the variables `STQ-ID` and `STQ-TRADE-DATA`. The code evaluates the SQL execution result using `SQLCODE`. If the fetch is successful (SQLCODE = 0), it moves the trade data to `TRD-ORDER-PAIR` and attempts to delete the corresponding record from the `TBTRDSTQ` table. If the delete operation fails, it captures the error code and prepares an exception message. If the fetch returns a code of 100, it sets a flag to stop processing. For any other SQLCODE, it also sets the stop flag and prepares an exception message. Overall, this code handles data retrieval and error management for trade settlements efficiently.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-TRADE-SETTLEMENT</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; STQ-TRADE-DATA</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; 88-STOP-SETTLEMENT</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-SETTLEMENT-SWITCH</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-PAIR</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; STQ-TRADE-DATA</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">FETCH <br>&nbsp;&nbsp;&nbsp;SETTLEMENT_QUEUE <br>INTO <br>&nbsp;&nbsp;&nbsp;:STQ-ID ,:STQ-TRADE-DATA </div>	<div class="cfq">execute a sql FETCH statement using cursor SETTLEMENT_QUEUE </div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">MOVE STQ-TRADE-DATA TO TRD-ORDER-PAIR</div>	<div class="cfq">copy variable STQ-TRADE-DATA to variable TRD-ORDER-PAIR</div></div><div class="explain">	<div class="bold-content">DELETE <br>&nbsp;&nbsp;&nbsp;<br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSTQ <br>WHERE <br>&nbsp;&nbsp;&nbsp; STQ_CURRENCY      = :STQ-CURRENCY AND STQ_ID            = :STQ-ID </div>	<div class="cfq">execute a sql DELETE statement from the TBTRDSTQ table </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Delete on TBTRDSTQ failed : ' 'SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Delete on TBTRDSTQ failed ) ,  value of String literal ('SQLCODE = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET 88-STOP-SETTLEMENT TO TRUE</div>	<div class="cfq">set variable 88-STOP-SETTLEMENT to true</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET 88-STOP-SETTLEMENT TO TRUE</div>	<div class="cfq">set variable 88-STOP-SETTLEMENT to true</div></div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Fetch SETTLEMENT_QUEUE Cursor failed : ' 'SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Fetch SETTLEMENT_QUEUE Cursor failed ) ,  value of String literal ('SQLCODE = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div><div id="content6" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 8000-UPDATE-ORDER is designed to update the status of an order in a database table (TBTRDORD) based on specific criteria. Initially, it sets a flag to indicate that a SQL operation will be performed and initializes the SQL error code. It then executes an SQL UPDATE statement to modify the order status.If the SQL operation encounters specific errors (-911 or -913), it sets a retry flag. If any other error occurs, it captures the SQL error code, flags an application exception, and logs an error message. Subsequently, it checks if the order status is either "REJECTED" or "SETTLED." Depending on the order type (buy or sell), it initializes a customer summary record and sets appropriate flags before logging the summary. This process ensures that order updates are handled correctly and exceptions are reported.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 11</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 2000-ACCOUNTING</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-DEBIT-CREDIT-SW</div>        			<div class="cfqs">&emsp;&larr; 88-SUMMARY-DEBIT</div>        			<div class="cfqs">&emsp;&larr; SETTLED</div>        			<div class="cfqs">&emsp;&larr; DO-SQL</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-RETRY-SWITCH</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-REC</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; 88-SUMMARY-NO-BOOKING</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; SQL-DONE</div>        			<div class="cfqs">&emsp;&larr; RETRY-SQL</div>        			<div class="cfqs">&emsp;&larr; REJECTED</div>        			<div class="cfqs">&emsp;&larr; 88-SUMMARY-CREDIT</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">SET DO-SQL TO TRUE</div>	<div class="cfq">set variable DO-SQL to true</div></div><div class="explain">	<div class="bold-content">MOVE 0 TO SQLCODE</div>	<div class="cfq">initialize variable SQLCODE with 0</div></div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDORD <br>SET <br>&nbsp;&nbsp;&nbsp;ORD_STATUS = :ORD-STATUS <br>WHERE <br>&nbsp;&nbsp;&nbsp;ORD_CURRENCY      = :ORD-CURRENCY AND   ORD_TRADING_XCHNG = :ORD-TRADING-XCHNG AND   ORD_TRADEID       = :ORD-TRADEID AND   ORD_FIGI          = :ORD-FIGI AND   ORD_BUY_SELL_IND  = :ORD-BUY-SELL-IND </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = -911 OR -913 THEN</div>	<div class="cfq">If condition (SQLCODE = -911 OR -913) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET RETRY-SQL TO TRUE</div>	<div class="cfq">set variable RETRY-SQL to true</div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET SQL-DONE TO TRUE</div>	<div class="cfq">set variable SQL-DONE to true</div></div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Update of Order failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Update of Order failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">MOVE ORD-STATUS TO WS-ORDER-STATUS</div>	<div class="cfq">copy variable ORD-STATUS to variable WS-ORDER-STATUS</div></div><div class="explain">	<div class="bold-content">IF REJECTED OR SETTLED</div>	<div class="cfq">If condition (REJECTED OR SETTLED) is true, then do the following: </div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq">initialize the variable WS-CUSTOMER-SUMMARY-REC with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">IF REJECTED</div>	<div class="cfq">If condition (REJECTED) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET 88-SUMMARY-NO-BOOKING TO TRUE</div>	<div class="cfq">set variable 88-SUMMARY-NO-BOOKING to true</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">IF ORD-BUY-SELL-IND = 'B' THEN</div>	<div class="cfq">If condition (ORD-BUY-SELL-IND = 'B') is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-ID TO WS-SUMMARY-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-BUYER-ID to variable WS-SUMMARY-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SET 88-SUMMARY-DEBIT TO TRUE</div>	<div class="cfq">set variable 88-SUMMARY-DEBIT to true</div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-ID TO WS-SUMMARY-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-SELLER-ID to variable WS-SUMMARY-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SET 88-SUMMARY-CREDIT TO TRUE</div>	<div class="cfq">set variable 88-SUMMARY-CREDIT to true</div></div></div><div class="explain">	<div class="bold-content">PERFORM 8001-LOG-SUMMARY THRU 8001-EXIT</div>	<div class="cfq">execute paragraph 8001-LOG-SUMMARY</div></div></div></div></div></div></div><div id="content7" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 9000-REPORT-EXCEPTION is designed to handle exceptions by categorizing them and preparing relevant data for further processing. It begins by copying the content of the variable WS-EXCEPTION into EXCEPTION-DESC and initializes the length of the exception record. The code then evaluates the type of exception encountered???either SYSTEM, APPLICATION, or DATA???updating the EXCEPTION-TYPE variable accordingly. After determining the exception type, it increments the length of the exception record by 46. Finally, the code calls an exception handler program (WS-EXCEPTION-HANDLER), passing the updated length and the exception record as parameters. This structured approach ensures that exceptions are logged and handled appropriately, facilitating effective error management within the application.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 4</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 5000-READ-FROM-STLMT-QUEUE</div>        			<div class="cfqs">&emsp;&rarr; 0000-MAINLINE</div>        			<div class="cfqs">&emsp;&rarr; 2002-MAC-BOOKING</div>        			<div class="cfqs">&emsp;&rarr; 8000-UPDATE-ORDER</div>        			<div class="cfqs">&emsp;&rarr; 2001-SAC-BOOKING</div>        			<div class="cfqs">&emsp;&rarr; 8001-LOG-SUMMARY</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&rarr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; SYSTEM-EXCEPTION</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-DESC</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-RECORD-LEN</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-TYPE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">MOVE WS-EXCEPTION TO EXCEPTION-DESC</div>	<div class="cfq">copy variable WS-EXCEPTION to variable EXCEPTION-DESC</div></div><div class="explain">	<div class="bold-content">MOVE LENGTH OF WS-EXCEPTION TO EXCEPTION-RECORD-LEN</div>	<div class="cfq">copy function (null) to variable EXCEPTION-RECORD-LEN</div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SYSTEM-EXCEPTION</div>	<div class="cfq">when SYSTEM-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'SYSTEM' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'SYSTEM'</div></div></div><div class="explain">	<div class="bold-content">WHEN APPL-EXCEPTION</div>	<div class="cfq">when APPL-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'APPLICATION' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'APPLICATION'</div></div></div><div class="explain">	<div class="bold-content">WHEN DATA-EXCEPTION</div>	<div class="cfq">when DATA-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'DATA' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'DATA'</div></div></div><div class="explain">	<div class="bold-content">ADD 46 TO EXCEPTION-RECORD-LEN</div>	<div class="cfq">increment variable EXCEPTION-RECORD-LEN by 46</div></div><div class="explain">	<div class="bold-content">CALL WS-EXCEPTION-HANDLER USING EXCEPTION-RECORD-LEN , EXCEPTION-RECORD</div>	<div class="cfq">invoke a program using variable WS-EXCEPTION-HANDLER, the actual program name is 'TRDPBEXC' using parameters variable EXCEPTION-RECORD-LEN-GROUP,variable EXCEPTION-RECORD</div></div></div></div><div id="content8" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the 8001-LOG-SUMMARY paragraph processes customer summary data from the TBTRDSUM table. It begins by moving a customer ID into a working variable and attempts to select relevant summary fields for that customer. If the SQL operation fails, it logs an error. Upon successful retrieval, it checks the SQL code to determine if the customer summary exists. If not, it initializes summary fields to zero. The code then evaluates transaction types (overdue, rejected, settled) and updates summary fields accordingly. Depending on the transaction type (debit or credit), it adjusts balances and may insert or update records in the database. Finally, it handles any exceptions that arise during these operations, ensuring robust error reporting and management throughout the process.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 30</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 8000-UPDATE-ORDER</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-AMOUNT</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-DEBIT</div>        			<div class="cfqs">&emsp;&rarr; WS-SUMMARY-DEBIT-CREDIT-SW</div>        			<div class="cfqs">&emsp;&rarr; SETTLED</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-NO-BOOKING</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; OVERDUE</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-CREDIT</div>        			<div class="cfqs">&emsp;&rarr; REJECTED</div>        			<div class="cfqs">&emsp;&rarr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&rarr; DCLTBTRDSUM</div>        			<div class="cfqs">&emsp;&rarr; MAC-BALANCE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SUM-SETTLED</div>        			<div class="cfqs">&emsp;&larr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&larr; SUM-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; SUM-CLOSE-BALANCE</div>        			<div class="cfqs">&emsp;&larr; SUM-REJECTED</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-WRITE-SW</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-SUMMARY-REWRITE</div>        			<div class="cfqs">&emsp;&larr; SUM-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; MAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SUM-TOTAL-CREDIT</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SUM-OPEN-BALANCE</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-SUMMARY-WRITE</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-REC</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; SUM-TOTAL-DEBIT</div>        			<div class="cfqs">&emsp;&larr; SUM-OVERDUE</div>        			<div class="cfqs">&emsp;&larr; DCLTBTRDSUM</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>	</div><div class="explain">	<div class="bold-content">MOVE WS-SUMMARY-CUSTOMER-ID TO SUM-CUSTOMER-ID</div>	<div class="cfq">copy variable WS-SUMMARY-CUSTOMER-ID to variable SUM-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID ,SUM_OVERDUE ,SUM_REJECTED ,SUM_SETTLED ,SUM_CURRENCY ,SUM_OPEN_BALANCE ,SUM_TOTAL_DEBIT ,SUM_TOTAL_CREDIT ,SUM_CLOSE_BALANCE <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>WHERE <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID = :SUM-CUSTOMER-ID FOR <br>UPDATE <br>&nbsp;&nbsp;&nbsp;OF SUM_OVERDUE ,SUM_REJECTED ,SUM_SETTLED ,SUM_CURRENCY ,SUM_OPEN_BALANCE ,SUM_TOTAL_DEBIT ,SUM_TOTAL_CREDIT ,SUM_CLOSE_BALANCE </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDSUM table </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor OPEN Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor OPEN Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">FETCH <br>&nbsp;&nbsp;&nbsp;SUMMARY_CSR <br>INTO <br>&nbsp;&nbsp;&nbsp;:SUM-CUSTOMER-ID ,:SUM-OVERDUE ,:SUM-REJECTED ,:SUM-SETTLED ,:SUM-CURRENCY ,:SUM-OPEN-BALANCE ,:SUM-TOTAL-DEBIT ,:SUM-TOTAL-CREDIT ,:SUM-CLOSE-BALANCE </div>	<div class="cfq">execute a sql FETCH statement using cursor SUMMARY_CSR </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 OR 100 THEN</div>	<div class="cfq">If condition (SQLCODE = 0 OR 100) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor OPEN Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor OPEN Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 100 THEN</div>	<div class="cfq">If condition (SQLCODE = 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET 88-CUSTOMER-SUMMARY-WRITE TO TRUE</div>	<div class="cfq">set variable 88-CUSTOMER-SUMMARY-WRITE to true</div></div><div class="explain">	<div class="bold-content">MOVE ZERO TO SUM-OVERDUE SUM-REJECTED SUM-SETTLED SUM-CURRENCY SUM-OPEN-BALANCE SUM-TOTAL-DEBIT SUM-TOTAL-CREDIT SUM-CLOSE-BALANCE</div>	<div class="cfq">initialize variable SUM-OVERDUE & variable SUM-REJECTED & variable SUM-SETTLED & variable SUM-CURRENCY & variable SUM-OPEN-BALANCE & variable SUM-TOTAL-DEBIT & variable SUM-TOTAL-CREDIT & variable SUM-CLOSE-BALANCE with ZERO</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET 88-CUSTOMER-SUMMARY-REWRITE TO TRUE</div>	<div class="cfq">set variable 88-CUSTOMER-SUMMARY-REWRITE to true</div></div><div class="explain">	<div class="bold-content">MOVE DCLTBTRDSUM TO WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq">copy variable DCLTBTRDSUM to variable WS-CUSTOMER-SUMMARY-REC</div></div><div class="explain">	<div class="bold-content">IF ( 88-SUMMARY-DEBIT OR 88-SUMMARY-CREDIT ) AND SUM-OPEN-BALANCE = 0 THEN</div>	<div class="cfq">If condition (( 88-SUMMARY-DEBIT OR 88-SUMMARY-CREDIT ) AND SUM-OPEN-BALANCE = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO MAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable MAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">IF TRD-BUYER-ID = SUM-CUSTOMER-ID</div>	<div class="cfq">If condition (TRD-BUYER-ID = SUM-CUSTOMER-ID) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-MONEY-ACC-NUM TO MAC-NUMBER</div>	<div class="cfq">copy variable TRD-BUYER-MONEY-ACC-NUM to variable MAC-NUMBER</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-MONEY-ACC-NUM TO MAC-NUMBER</div>	<div class="cfq">copy variable TRD-SELLER-MONEY-ACC-NUM to variable MAC-NUMBER</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp; MAC_BALANCE <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDMAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;MAC_CURRENCY   = :MAC-CURRENCY AND MAC_NUMBER     = :MAC-NUMBER WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDMAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 THEN</div>	<div class="cfq">If condition (SQLCODE = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">IF TRD-BUYER-ID = SUM-CUSTOMER-ID</div>	<div class="cfq">If condition (TRD-BUYER-ID = SUM-CUSTOMER-ID) is true, then do the following: </div><div class="explain">	<div class="bold-content">COMPUTE SUM-OPEN-BALANCE = MAC-BALANCE + TRD-ORDER-AMOUNT</div>	<div class="cfq">computes the expression "variable MAC-BALANCE + variable TRD-ORDER-AMOUNT  and stores the final result into variable SUM-OPEN-BALANCE</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">COMPUTE SUM-OPEN-BALANCE = MAC-BALANCE - TRD-ORDER-AMOUNT</div>	<div class="cfq">computes the expression "variable MAC-BALANCE - variable TRD-ORDER-AMOUNT  and stores the final result into variable SUM-OPEN-BALANCE</div></div><div class="explain">	<div class="bold-content">MOVE SUM-OPEN-BALANCE TO SUM-CLOSE-BALANCE</div>	<div class="cfq">copy variable SUM-OPEN-BALANCE to variable SUM-CLOSE-BALANCE</div></div></div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN OVERDUE</div>	<div class="cfq">when OVERDUE</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-OVERDUE</div>	<div class="cfq">increment variable SUM-OVERDUE by 1</div></div></div><div class="explain">	<div class="bold-content">WHEN REJECTED</div>	<div class="cfq">when REJECTED</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-REJECTED</div>	<div class="cfq">increment variable SUM-REJECTED by 1</div></div></div><div class="explain">	<div class="bold-content">WHEN SETTLED</div>	<div class="cfq">when SETTLED</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-SETTLED</div>	<div class="cfq">increment variable SUM-SETTLED by 1</div></div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-DEBIT</div>	<div class="cfq">when 88-SUMMARY-DEBIT</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SUM-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SUM-CURRENCY</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-TOTAL-DEBIT</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-TOTAL-DEBIT</div></div><div class="explain">	<div class="bold-content">SUBTRACT TRD-ORDER-AMOUNT FROM SUM-CLOSE-BALANCE</div>	<div class="cfq">subtract variable TRD-ORDER-AMOUNT from variable SUM-CLOSE-BALANCE</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-CREDIT</div>	<div class="cfq">when 88-SUMMARY-CREDIT</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SUM-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SUM-CURRENCY</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-TOTAL-CREDIT</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-TOTAL-CREDIT</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-CLOSE-BALANCE</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-CLOSE-BALANCE</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-NO-BOOKING</div>	<div class="cfq">when 88-SUMMARY-NO-BOOKING</div></div><div class="explain">	<div class="bold-content">IF 88-CUSTOMER-SUMMARY-WRITE</div>	<div class="cfq">If condition (88-CUSTOMER-SUMMARY-WRITE) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE WS-CUSTOMER-SUMMARY-REC TO DCLTBTRDSUM</div>	<div class="cfq">copy variable WS-CUSTOMER-SUMMARY-REC to variable DCLTBTRDSUM</div></div><div class="explain">	<div class="bold-content">INSERT INTO INTO <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>VALUES <br>&nbsp;&nbsp;&nbsp;( :SUM-CUSTOMER-ID ,:SUM-OVERDUE ,:SUM-REJECTED ,:SUM-SETTLED ,:SUM-CURRENCY ,:SUM-OPEN-BALANCE ,:SUM-TOTAL-DEBIT ,:SUM-TOTAL-CREDIT ,:SUM-CLOSE-BALANCE ) </div>	<div class="cfq">execute a sql INSERT statement using cursor INSERT </div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>SET <br>&nbsp;&nbsp;&nbsp;SUM_OVERDUE       = :SUM-OVERDUE ,SUM_REJECTED      = :SUM-REJECTED ,SUM_SETTLED       = :SUM-SETTLED ,SUM_CURRENCY      = :SUM-CURRENCY ,SUM_OPEN_BALANCE  = :SUM-OPEN-BALANCE ,SUM_TOTAL_DEBIT   = :SUM-TOTAL-DEBIT ,SUM_TOTAL_CREDIT  = :SUM-TOTAL-CREDIT ,SUM_CLOSE_BALANCE = :SUM-CLOSE-BALANCE <br>WHERE <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID = :SUM-CUSTOMER-ID </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 THEN</div>	<div class="cfq">If condition (SQLCODE = 0) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Insert/Update Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Insert/Update Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">CLOSE SUMMARY_CSR </div>	<div class="cfq">execute a sql CLOSE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor CLOSE Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor CLOSE Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div></div></div></div></div></div></div>		</div>    </div>        </div>	<script>        function showContent(contentId, button) {            document.getElementById('content').scrollTop = 0;			var contentItems = document.querySelectorAll('.content-item');			contentItems.forEach(function (item) {			item.classList.remove('active');			});			var sidebarButtons = document.querySelectorAll('.sidebar button');			sidebarButtons.forEach(function (btn) {				btn.classList.remove('active');			});			var activeContent = document.getElementById(contentId);			if (activeContent) {					activeContent.classList.add('active');				}			if (button) {				button.classList.add('active');			}		}		window.onload = function () {			var defaultButton = document.querySelector('.sidebar button');			if (defaultButton) {				defaultButton.classList.add('active');				showContent('contentProcDiv', defaultButton);			}		}		</script>				<!-- smart-doc footer -->    </body></html>