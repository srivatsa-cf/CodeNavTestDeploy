<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>TRDPB000</title>    <style>        html,        body {            margin: 0;            padding: 0;            height: 100%;            border: 0;            display: flex;            flex-direction: column;        }        .container {            display: flex;            flex: 1;        }        .sidebar {            width: 20%;            background-color: #f4f4f4;            padding: 10px;            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);            text-align: left;            box-sizing: border-box;	    overflow-y: auto;            font-family: 'Consolas', monospace;        }        .sidebar button {            width: 100%;            padding: 10px;            margin: 5px 0;            border: none;            background-color: #282828;            color: #33FF33;            cursor: pointer;            font-size: 16px;            text-align: left;            font-family: 'Consolas', monospace;        }        .sidebar button:hover {            background-color: black;        }        .sidebar button.active {            background-color: #33FF33;            color: #282828;            font-weight: bold;        }        .content {            flex: 1;            padding: 10px;            overflow-y: auto;        }        .content-item {            display: none;        }        .content-item.active {            display: block;        }        .codes {            font-weight: bold;            font-size: 18px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            line-height: 1.6;        }        .explain {            border: 1px solid #bbb;            margin: 10px;            padding: 10px;            justify-content: center;            border-radius: 10px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;        }        .code2 {            background-color: #282828;            color: #33FF33;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: 18px;            font-weight: bold;            border-style: solid;            line-height: 1.6;        }        .bold-content {            color: #33FF33;            font-size: 18px;            font-weight: 900;            line-height: 1.5;            font-family: 'Consolas', monospace;            background-color: black;            padding: 0px;            /* margin: 20px; */        }        .cfq {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: 18px;            line-height: 1.6;        }        .cfqs {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            line-height: 1.6;            font-size: 18px;        }        .llm {            margin-top: 10px;            color: #fff;            --tw-bg-opacity: 1;            background-color: white;            color: black;            font-family: 'Barlow';            font-size: 18px;            line-height: 1.6;        }        .para {            margin-top: 10px;            color: black;            --tw-bg-opacity: 1;            background-color: white;            font-family: 'Barlow';            font-weight: bold;            font-size: 18px;            line-height: 1.6;        }        .explains {            background-color: white;        }        .main-content {            display: flex;            flex: 1;            overflow-y: hidden;            font-family: 'Consolas', monospace;            background-color: white;            min-height: 80vh;        }        .indent-container {            margin-left: 20px;        }        .file-name {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-weight: bold;            font-size: large;            padding: 10px;            background-color: #f4f4f4;            border-bottom: 2px solid #ccc;            margin-bottom: 10px;        }        .file-content {            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            font-size: large;           position: absolute;           left: 50%;           font-size: 18px;           transform: translateX(-50%);        }        .weight-text {            font-size: 18px;        }                .footer {            background-color: #000;            color: #fff;            padding: 2px;            padding-left: 20px;            font-size: 16px;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;        }        .footer-content {            display: flex;            justify-content: space-between;            align-items: center;        }        .footer-content img {            width: 160px;            height: auto;        }        .footer-content p{            padding-right: 20px;            font-size: 18px;        }        .header {            background-color: rgb(11, 78, 221);            color: #fff;            text-align: left;            display: flex;            flex-wrap: wrap;            align-items: center;            justify-content: space-between;            padding: 10px 20px;            font-size: 4vw;            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;            height: auto;        }        .header img {            flex-shrink: 0;            width: 10vw;            height: auto;            margin-right: 25px;            padding-bottom: 8px;        }        .header span {            flex-grow: 1;            font-size: 1.5vw;        }        @media screen and (max-width: 768px) {            .header{                font-size: 5vw;                padding: 10px 20px;                flex-direction: column;                align-items: flex-start;            }            .header img {                width: 20vw;                margin-right: 15px;            }            .header span {                font-size: 4vw;            }        }    </style></head><body>        <!-- smart-doc header -->	    <div class="main-content">        <div class="sidebar" id="sidebar">            <button onclick="showContent('contentProcDiv', this)" class="active">PROCEDURE DIVISION</button>            <div class="indent-container">				<button onclick="showContent('content0', this)">0000-MAINLINE</button>				<button onclick="showContent('content1', this)">1000-ORDER-ACCEPTANCE</button>				<button onclick="showContent('content2', this)">5000-GET-SELL-SIDE-ORDER</button>				<button onclick="showContent('content3', this)">5001-VALIDATE-CUSTOMERS</button>				<button onclick="showContent('content4', this)">5002-VALIDATE-SECURITY</button>				<button onclick="showContent('content5', this)">5003-BUYER-SEC-ACCOUNT</button>				<button onclick="showContent('content6', this)">5004-SELLER-SEC-ACCOUNT</button>				<button onclick="showContent('content7', this)">5005-BUYER-MONEY-ACCOUNT</button>				<button onclick="showContent('content8', this)">5006-SELLER-MONEY-ACCOUNT</button>				<button onclick="showContent('content9', this)">5007-UPDATE-ORDER-MATCHED</button>				<button onclick="showContent('content10', this)">5008-WRITE-TO-STLMT-QUEUE</button>				<button onclick="showContent('content11', this)">5009-INSERT-TO-STQ</button>				<button onclick="showContent('content12', this)">8000-UPDATE-ORDER</button>				<button onclick="showContent('content13', this)">9000-REPORT-EXCEPTION</button>				<button onclick="showContent('content14', this)">8001-LOG-SUMMARY</button>            </div>        </div>        <div class="content" id="content"><div id="content0" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet implements a process for handling currency validation and logging transactions. If the currency is valid, the program proceeds without action. If invalid, it sets an exception flag, logs an error message, and ensures a minimum check frequency. The code initializes transaction logging variables, captures the current date and time, and formats them for logging. It then attempts to insert a new transaction record into the database. If the insertion fails due to a duplicate entry (SQLCODE -803), it updates the existing record instead. The program handles any SQL errors by logging appropriate messages and reporting exceptions. Finally, it commits the transaction and returns control to the calling program. This structure ensures robust error handling and transaction management within the application.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 16</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; Procedure Division</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; VALID-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; LK-CHKP-FREQUENCY</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-CURRDATE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; DCLTBTRDLOG</div>        			<div class="cfqs">&emsp;&larr; LOG-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; LK-CHKP-FREQUENCY</div>        			<div class="cfqs">&emsp;&larr; LOG-TRANSACTION</div>        			<div class="cfqs">&emsp;&larr; WS-CURRTIME</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SYSTEM-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; LOG-START-TS</div>        			<div class="cfqs">&emsp;&larr; LOG-END-TS</div>        			<div class="cfqs">&emsp;&larr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>	</div><div class="explain">	<div class="bold-content">IF VALID-CURRENCY THEN</div>	<div class="cfq">If condition (VALID-CURRENCY) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET SYSTEM-EXCEPTION TO TRUE</div>	<div class="cfq">set variable SYSTEM-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING LK-CURRENCY ' : ' 'Currency parameter passed is invalid' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of variable LK-CURRENCY ,  value of String literal (' ) ,  value of String literal ('Currency parameter passed is invalid') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">IF LK-CHKP-FREQUENCY < 100 THEN</div>	<div class="cfq">If condition (LK-CHKP-FREQUENCY < 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE 100 TO LK-CHKP-FREQUENCY</div>	<div class="cfq">initialize variable LK-CHKP-FREQUENCY with 100</div></div></div><div class="explain">	<div class="bold-content">INITIALIZE DCLTBTRDLOG</div>	<div class="cfq">initialize the variable DCLTBTRDLOG with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE DCLTBTRDLOG</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">MOVE 'ACCEPTANCE' TO LOG-TRANSACTION</div>	<div class="cfq">initialize variable LOG-TRANSACTION with 'ACCEPTANCE'</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRDATE FROM DATE YYYYMMDD</div>	<div class="cfq">copy current system date using format YYYYMMDD into variable WS-CURRDATE</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRTIME FROM TIME</div>	<div class="cfq">copy current system time  into variable WS-CURRTIME</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO LOG-START-TS</div>	<div class="cfq">initialize variable LOG-START-TS with SPACE</div></div><div class="explain">	<div class="bold-content">STRING WS-CURRDATE (1 : 4) '-' WS-CURRDATE (5 : 2) '-' WS-CURRDATE (7 : 2) ' ' WS-CURRTIME (1 : 2) ':' WS-CURRTIME (3 : 2) ':' WS-CURRTIME (5 : 2) DELIMITED BY SIZE INTO LOG-START-TS END-STRING</div>	<div class="cfq">Concatenates  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal (' ') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) and stores the final result into variable LOG-START-TS.</div></div><div class="explain">	<div class="bold-content">PERFORM 1000-ORDER-ACCEPTANCE THRU 1000-EXIT</div>	<div class="cfq">execute paragraph 1000-ORDER-ACCEPTANCE</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRDATE FROM DATE YYYYMMDD</div>	<div class="cfq">copy current system date using format YYYYMMDD into variable WS-CURRDATE</div></div><div class="explain">	<div class="bold-content">ACCEPT WS-CURRTIME FROM TIME</div>	<div class="cfq">copy current system time  into variable WS-CURRTIME</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO LOG-END-TS</div>	<div class="cfq">initialize variable LOG-END-TS with SPACE</div></div><div class="explain">	<div class="bold-content">STRING WS-CURRDATE (1 : 4) '-' WS-CURRDATE (5 : 2) '-' WS-CURRDATE (7 : 2) ' ' WS-CURRTIME (1 : 2) ':' WS-CURRTIME (3 : 2) ':' WS-CURRTIME (5 : 2) DELIMITED BY SIZE INTO LOG-END-TS END-STRING</div>	<div class="cfq">Concatenates  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal ('-') ,  value of substring (WS-CURRDATE) ,  value of String literal (' ') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) ,  value of String literal (') ,  value of substring (WS-CURRTIME) and stores the final result into variable LOG-END-TS.</div></div><div class="explain">	<div class="bold-content">INSERT INTO INTO <br>&nbsp;&nbsp;&nbsp;TBTRDLOG <br>VALUES <br>&nbsp;&nbsp;&nbsp;( :LOG-TRANSACTION ,:LOG-CURRENCY ,:LOG-START-TS ,:LOG-END-TS ) </div>	<div class="cfq">execute a sql INSERT statement using cursor INSERT </div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SQLCODE = 0</div>	<div class="cfq">when SQLCODE is 0</div></div><div class="explain">	<div class="bold-content">WHEN SQLCODE = -803</div>	<div class="cfq">when SQLCODE is -803</div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDLOG <br>SET <br>&nbsp;&nbsp;&nbsp;LOG_END_TS = :LOG-END-TS <br>WHERE <br>&nbsp;&nbsp;&nbsp;LOG_TRANSACTION = :LOG-TRANSACTION AND LOG_CURRENCY    = :LOG-CURRENCY </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'LOG Update Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('LOG Update Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'LOG Insert Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('LOG Insert Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">COMMIT <br>&nbsp;&nbsp;&nbsp;</div>	<div class="cfq">execute a sql COMMIT statement </div></div><div class="explain">	<div class="bold-content">GOBACK</div>	<div class="cfq">returns control to the caller but the parent process continues to execute</div></div></div></div></div><div id="content1" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the `1000-ORDER-ACCEPTANCE` paragraph processes currency-based trading orders. It begins by transferring the currency from a local variable to the order currency and a working storage array. Based on the currency type, it assigns the corresponding trading exchange. The code then executes a SQL SELECT statement to retrieve buy-side orders from a database. If the retrieval fails or returns no results, it handles exceptions accordingly. For each valid order, it increments a counter and performs a series of validations on customer and security accounts. If all validations pass, it updates the matched orders and writes to a settlement queue. The code also manages transaction commits based on a specified frequency. Finally, it ensures proper closure of database cursors and handles any exceptions that arise during the process. Overall, this code facilitates the acceptance and processing of trading orders while ensuring data integrity and error handling.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 40</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 0000-MAINLINE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-STQ-INDEX</div>        			<div class="cfqs">&emsp;&rarr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; ORD-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&rarr; ORD-QUANTITY</div>        			<div class="cfqs">&emsp;&rarr; ORD-AMOUNT</div>        			<div class="cfqs">&emsp;&rarr; LK-CHKP-FREQUENCY</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-STQ-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-COUNT</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-AMOUNT</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-QUANTITY</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-ORDERS-SWITCH</div>        			<div class="cfqs">&emsp;&larr; NO-EXCEPTIONS</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; ORD-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-STQ-INDEX</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-QTY</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; ACCEPTED</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; NO-MORE-ORDERS</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-AMOUNT</div>	</div><div class="explain">	<div class="bold-content">MOVE LK-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable LK-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE LK-CURRENCY TO WS-STQ-CURRENCY ( WS-STQ-INDEX )</div>	<div class="cfq">copy variable LK-CURRENCY to array WS-STQ-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-STQ-INDEX</div>	<div class="cfq">initialize variable WS-STQ-INDEX with 0</div></div><div class="explain">	<div class="bold-content">EVALUATE ORD-CURRENCY</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 'EUR'</div>	<div class="cfq">when String literal ('EUR')</div><div class="explain">	<div class="bold-content">MOVE 'DAX' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'DAX'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'USD'</div>	<div class="cfq">when String literal ('USD')</div><div class="explain">	<div class="bold-content">MOVE 'NYSE' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'NYSE'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'CAD'</div>	<div class="cfq">when String literal ('CAD')</div><div class="explain">	<div class="bold-content">MOVE 'TSX' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'TSX'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'CNY'</div>	<div class="cfq">when String literal ('CNY')</div><div class="explain">	<div class="bold-content">MOVE 'SSE' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'SSE'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'INR'</div>	<div class="cfq">when String literal ('INR')</div><div class="explain">	<div class="bold-content">MOVE 'BSE' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'BSE'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'CHF'</div>	<div class="cfq">when String literal ('CHF')</div><div class="explain">	<div class="bold-content">MOVE 'SWX' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'SWX'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'JPY'</div>	<div class="cfq">when String literal ('JPY')</div><div class="explain">	<div class="bold-content">MOVE 'TSE' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'TSE'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'MXN'</div>	<div class="cfq">when String literal ('MXN')</div><div class="explain">	<div class="bold-content">MOVE 'BMV' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'BMV'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'KRW'</div>	<div class="cfq">when String literal ('KRW')</div><div class="explain">	<div class="bold-content">MOVE 'KRX' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'KRX'</div></div></div><div class="explain">	<div class="bold-content">WHEN 'GBX'</div>	<div class="cfq">when String literal ('GBX')</div><div class="explain">	<div class="bold-content">MOVE 'FTSE' TO ORD-TRADING-XCHNG</div>	<div class="cfq">initialize variable ORD-TRADING-XCHNG with 'FTSE'</div></div></div><div class="explain">	<div class="bold-content">SET ACCEPTED TO TRUE</div>	<div class="cfq">set variable ACCEPTED to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp; ORD_TRADEID ,ORD_BUY_SELL_IND ,ORD_CUSTOMER_ID ,ORD_FIGI ,ORD_QUANTITY ,ORD_CURRENCY ,ORD_AMOUNT <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDORD <br>WHERE <br>&nbsp;&nbsp;&nbsp;ORD_CURRENCY      = :ORD-CURRENCY AND ORD_TRADING_XCHNG = :ORD-TRADING-XCHNG AND ORD_BUY_SELL_IND  = 'B' AND ORD_STATUS        = :ORD-STATUS </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDORD table </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Open BUY_SIDE_ORDERS Cursor failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Open BUY_SIDE_ORDERS Cursor failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">FETCH <br>&nbsp;&nbsp;&nbsp;BUY_SIDE_ORDERS <br>INTO <br>&nbsp;&nbsp;&nbsp;:ORD-TRADEID ,:ORD-BUY-SELL-IND ,:ORD-CUSTOMER-ID ,:ORD-FIGI ,:ORD-QUANTITY ,:ORD-CURRENCY ,:ORD-AMOUNT </div>	<div class="cfq">execute a sql FETCH statement using cursor BUY_SIDE_ORDERS </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 100 THEN</div>	<div class="cfq">If condition (SQLCODE = 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET NO-MORE-ORDERS TO TRUE</div>	<div class="cfq">set variable NO-MORE-ORDERS to true</div></div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'No BUY_SIDE_ORDERS to Settle ' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('No BUY_SIDE_ORDERS to Settle ') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-ORDER-COUNT</div>	<div class="cfq">initialize variable WS-ORDER-COUNT with 0</div></div><div class="explain">	<div class="bold-content">ADD 1 TO WS-ORDER-COUNT</div>	<div class="cfq">increment variable WS-ORDER-COUNT by 1</div></div><div class="explain">	<div class="bold-content">SET NO-EXCEPTIONS TO TRUE</div>	<div class="cfq">set variable NO-EXCEPTIONS to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADING-XCHNG TO TRD-EXCHANGE</div>	<div class="cfq">copy variable ORD-TRADING-XCHNG to variable TRD-EXCHANGE</div></div><div class="explain">	<div class="bold-content">MOVE ORD-CUSTOMER-ID TO TRD-BUYER-ID</div>	<div class="cfq">copy variable ORD-CUSTOMER-ID to variable TRD-BUYER-ID</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO TRD-ORDER-ID</div>	<div class="cfq">copy variable ORD-TRADEID to variable TRD-ORDER-ID</div></div><div class="explain">	<div class="bold-content">MOVE ORD-FIGI TO TRD-FIGI</div>	<div class="cfq">copy variable ORD-FIGI to variable TRD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE ORD-QUANTITY TO TRD-ORDER-QTY</div>	<div class="cfq">copy variable ORD-QUANTITY to variable TRD-ORDER-QTY</div></div><div class="explain">	<div class="bold-content">MOVE ORD-CURRENCY TO TRD-CURRENCY</div>	<div class="cfq">copy variable ORD-CURRENCY to variable TRD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE ORD-AMOUNT TO TRD-ORDER-AMOUNT</div>	<div class="cfq">copy variable ORD-AMOUNT to variable TRD-ORDER-AMOUNT</div></div><div class="explain">	<div class="bold-content">PERFORM 5000-GET-SELL-SIDE-ORDER THRU 5000-EXIT</div>	<div class="cfq">execute paragraph 5000-GET-SELL-SIDE-ORDER</div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5001-VALIDATE-CUSTOMERS THRU 5001-EXIT</div>	<div class="cfq">execute paragraph 5001-VALIDATE-CUSTOMERS</div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5002-VALIDATE-SECURITY THRU 5002-EXIT</div>	<div class="cfq">execute paragraph 5002-VALIDATE-SECURITY</div></div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5003-BUYER-SEC-ACCOUNT THRU 5003-EXIT</div>	<div class="cfq">execute paragraph 5003-BUYER-SEC-ACCOUNT</div></div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5004-SELLER-SEC-ACCOUNT THRU 5004-EXIT</div>	<div class="cfq">execute paragraph 5004-SELLER-SEC-ACCOUNT</div></div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5005-BUYER-MONEY-ACCOUNT THRU 5005-EXIT</div>	<div class="cfq">execute paragraph 5005-BUYER-MONEY-ACCOUNT</div></div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5006-SELLER-MONEY-ACCOUNT THRU 5006-EXIT</div>	<div class="cfq">execute paragraph 5006-SELLER-MONEY-ACCOUNT</div></div></div><div class="explain">	<div class="bold-content">IF NO-EXCEPTIONS</div>	<div class="cfq">If condition (NO-EXCEPTIONS) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5007-UPDATE-ORDER-MATCHED THRU 5007-EXIT</div>	<div class="cfq">execute paragraph 5007-UPDATE-ORDER-MATCHED</div></div><div class="explain">	<div class="bold-content">PERFORM 5008-WRITE-TO-STLMT-QUEUE THRU 5008-EXIT</div>	<div class="cfq">execute paragraph 5008-WRITE-TO-STLMT-QUEUE</div></div><div class="explain">	<div class="bold-content">IF WS-ORDER-COUNT >= LK-CHKP-FREQUENCY</div>	<div class="cfq">If condition (WS-ORDER-COUNT >= LK-CHKP-FREQUENCY) is true, then do the following: </div><div class="explain">	<div class="bold-content">COMMIT <br>&nbsp;&nbsp;&nbsp;</div>	<div class="cfq">execute a sql COMMIT statement </div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-ORDER-COUNT</div>	<div class="cfq">initialize variable WS-ORDER-COUNT with 0</div></div></div></div><div class="explain">	<div class="bold-content">FETCH <br>&nbsp;&nbsp;&nbsp;BUY_SIDE_ORDERS <br>INTO <br>&nbsp;&nbsp;&nbsp;:ORD-TRADEID ,:ORD-BUY-SELL-IND ,:ORD-CUSTOMER-ID ,:ORD-FIGI ,:ORD-QUANTITY ,:ORD-CURRENCY ,:ORD-AMOUNT </div>	<div class="cfq">execute a sql FETCH statement using cursor BUY_SIDE_ORDERS </div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SQLCODE = 0</div>	<div class="cfq">when SQLCODE is 0</div></div><div class="explain">	<div class="bold-content">WHEN SQLCODE = 100</div>	<div class="cfq">when SQLCODE is 100</div><div class="explain">	<div class="bold-content">SET NO-MORE-ORDERS TO TRUE</div>	<div class="cfq">set variable NO-MORE-ORDERS to true</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Fetch BUY_SIDE_ORDERS failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Fetch BUY_SIDE_ORDERS failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div><div class="explain">	<div class="bold-content">CLOSE BUY_SIDE_ORDERS </div>	<div class="cfq">execute a sql CLOSE statement </div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SQLCODE = 0</div>	<div class="cfq">when SQLCODE is 0</div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Close BUY_SIDE_ORDERS failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Close BUY_SIDE_ORDERS failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">IF WS-STQ-INDEX > 0 THEN</div>	<div class="cfq">If condition (WS-STQ-INDEX > 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5009-INSERT-TO-STQ THRU 5009-EXIT</div>	<div class="cfq">execute paragraph 5009-INSERT-TO-STQ</div></div></div><div class="explain">	<div class="bold-content">COMMIT <br>&nbsp;&nbsp;&nbsp;</div>	<div class="cfq">execute a sql COMMIT statement </div></div></div></div></div></div><div id="content2" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5000-GET-SELL-SIDE-ORDER processes a sell-side order by first setting the order indicator to 'S'. It then executes a SQL SELECT statement to retrieve the customer ID and order status from the TBTRDORD table based on specific criteria. The code evaluates the SQL execution result using the SQLCODE. If the result is successful (SQLCODE 0), it checks if the order is accepted. If accepted, it assigns the customer ID to the seller ID; otherwise, it sets an exception flag and constructs an error message regarding the invalid order status. For SQLCODE 100 (not found), it similarly sets an exception and updates the order details. For any other SQLCODE, it flags an application exception. Finally, it updates the order with new values and performs necessary exception reporting.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; ORD-CUSTOMER-ID</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SELLER-ORDSTA-INVLD</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SELLER-ORD-MISSING</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; ACCEPTED</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>	</div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;ORD_CUSTOMER_ID , ORD_STATUS <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDORD <br>WHERE <br>&nbsp;&nbsp;&nbsp;ORD_CURRENCY      = :ORD-CURRENCY AND   ORD_TRADING_XCHNG = :ORD-TRADING-XCHNG AND   ORD_TRADEID       = :ORD-TRADEID AND   ORD_FIGI          = :ORD-FIGI AND   ORD_BUY_SELL_IND  = :ORD-BUY-SELL-IND WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDORD table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">MOVE ORD-STATUS TO WS-ORDER-STATUS</div>	<div class="cfq">copy variable ORD-STATUS to variable WS-ORDER-STATUS</div></div><div class="explain">	<div class="bold-content">IF ACCEPTED THEN</div>	<div class="cfq">If condition (ACCEPTED) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE ORD-CUSTOMER-ID TO TRD-SELLER-ID</div>	<div class="cfq">copy variable ORD-CUSTOMER-ID to variable TRD-SELLER-ID</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Side Order ' 'Status Invalid - Order Status = ' WS-ORDER-STATUS DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal ('Status Invalid - Order Status = ') ,  value of variable WS-ORDER-STATUS and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-ORDSTA-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-ORDSTA-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Side Order ' 'Not Found ' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal ('Not Found ') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-ORD-MISSING TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-ORD-MISSING to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Seller Order Select Failed - SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Seller Order Select Failed - SQLCODE = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div><div id="content3" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the `5001-VALIDATE-CUSTOMERS` paragraph is designed to validate customer information during an order acceptance process. Initially, it sets a flag indicating acceptance and initializes customer input data. It checks the buyer's status using a subroutine (`WS-CUSTOMER-CHECK`). Depending on the evaluation results, it handles various scenarios: if the customer is active, it proceeds; if not found or inactive, it logs an exception with relevant details and calls an exception reporting routine. If the buyer is invalid, it checks the seller's status similarly. If either the buyer or seller is invalid, it updates the order status and other related fields accordingly. This process ensures that only valid customers are processed in the order system, maintaining data integrity and proper exception handling.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 17</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; ORD-CUSTOMER-ID</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; OVERDUE-BUYER-ID-INVLD</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-INACTIVE</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-IO</div>        			<div class="cfqs">&emsp;&larr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-STATUS</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SELLER-ID-INVLD</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; ACCEPTED</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-ERROR-MSG</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-NOT-FOUND</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-ACTIVE</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>	</div><div class="explain">	<div class="bold-content">SET ACCEPTED TO TRUE</div>	<div class="cfq">set variable ACCEPTED to true</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-IO</div>	<div class="cfq">initialize the variable WS-CUSTOMER-IO with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-IO</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-ID TO WS-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-BUYER-ID to variable WS-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">CALL WS-CUSTOMER-CHECK USING WS-CUSTOMER-IO END-CALL</div>	<div class="cfq">invoke a program using variable WS-CUSTOMER-CHECK, the actual program name is 'MSTPB001' using parameter variable WS-CUSTOMER-IO</div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-ACTIVE</div>	<div class="cfq">when 88-CUSTOMER-ACTIVE</div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-NOT-FOUND</div>	<div class="cfq">when 88-CUSTOMER-NOT-FOUND</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Customer ' ORD-CUSTOMER-ID ' Not found' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-CUSTOMER-ID ,  value of String literal (' Not found') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-INACTIVE</div>	<div class="cfq">when 88-CUSTOMER-INACTIVE</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Customer ' ORD-CUSTOMER-ID ' Not Active' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-CUSTOMER-ID ,  value of String literal (' Not Active') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-EXCEPTION</div>	<div class="cfq">when 88-CUSTOMER-EXCEPTION</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-CUSTOMER-ERROR-MSG TO WS-EXCEPTION</div>	<div class="cfq">copy variable WS-CUSTOMER-ERROR-MSG to variable WS-EXCEPTION</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">IF 88-CUSTOMER-ACTIVE THEN</div>	<div class="cfq">If condition (88-CUSTOMER-ACTIVE) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET OVERDUE-BUYER-ID-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-BUYER-ID-INVLD to true</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-IO</div>	<div class="cfq">initialize the variable WS-CUSTOMER-IO with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-IO</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-ID TO WS-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-SELLER-ID to variable WS-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">CALL WS-CUSTOMER-CHECK USING WS-CUSTOMER-IO END-CALL</div>	<div class="cfq">invoke a program using variable WS-CUSTOMER-CHECK, the actual program name is 'MSTPB001' using parameter variable WS-CUSTOMER-IO</div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-ACTIVE</div>	<div class="cfq">when 88-CUSTOMER-ACTIVE</div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-NOT-FOUND</div>	<div class="cfq">when 88-CUSTOMER-NOT-FOUND</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Customer ' ORD-CUSTOMER-ID ' Not found' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-CUSTOMER-ID ,  value of String literal (' Not found') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-INACTIVE</div>	<div class="cfq">when 88-CUSTOMER-INACTIVE</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Customer ' ORD-CUSTOMER-ID ' Not Active' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-CUSTOMER-ID ,  value of String literal (' Not Active') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-CUSTOMER-EXCEPTION</div>	<div class="cfq">when 88-CUSTOMER-EXCEPTION</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-CUSTOMER-ERROR-MSG TO WS-EXCEPTION</div>	<div class="cfq">copy variable WS-CUSTOMER-ERROR-MSG to variable WS-EXCEPTION</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">IF 88-CUSTOMER-ACTIVE THEN</div>	<div class="cfq">If condition (88-CUSTOMER-ACTIVE) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-ID-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-ID-INVLD to true</div></div><div class="explain">	<div class="bold-content">IF OVERDUE-BUYER-ID-INVLD OR OVERDUE-SELLER-ID-INVLD</div>	<div class="cfq">If condition (OVERDUE-BUYER-ID-INVLD OR OVERDUE-SELLER-ID-INVLD) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div></div></div></div></div></div><div id="content4" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5002-VALIDATE-SECURITY is responsible for validating the security status of an order. It begins by initializing a workspace variable and copying the order's FIGI to a working variable. The code then calls a security check program. Based on the evaluation of the security status, it handles various conditions: if the security is not found or inactive, it sets an exception flag, logs an error message, and reports the exception. If the security is active, it updates the order details, including status, currency, exchange, and trade ID, and performs updates for both buy and sell indicators. Overall, this code ensures that only valid and active securities are processed, while also managing exceptions effectively.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 8</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-SECURITY-IO</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-SECURITY-ERROR-MSG</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; 88-SECURITY-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; 88-SECURITY-NOT-FOUND</div>        			<div class="cfqs">&emsp;&larr; 88-SECURITY-INACTIVE</div>        			<div class="cfqs">&emsp;&larr; WS-SECURITY-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SECURITY-INVLD</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; 88-SECURITY-ACTIVE</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>	</div><div class="explain">	<div class="bold-content">INITIALIZE WS-SECURITY-IO</div>	<div class="cfq">initialize the variable WS-SECURITY-IO with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-SECURITY-IO</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">MOVE ORD-FIGI TO WS-FIGI</div>	<div class="cfq">copy variable ORD-FIGI to variable WS-FIGI</div></div><div class="explain">	<div class="bold-content">CALL WS-SECURITY-CHECK USING WS-SECURITY-IO END-CALL</div>	<div class="cfq">invoke a program using variable WS-SECURITY-CHECK, the actual program name is 'MSTPB002' using parameter variable WS-SECURITY-IO</div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 88-SECURITY-ACTIVE</div>	<div class="cfq">when 88-SECURITY-ACTIVE</div></div><div class="explain">	<div class="bold-content">WHEN 88-SECURITY-NOT-FOUND</div>	<div class="cfq">when 88-SECURITY-NOT-FOUND</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : SECURITY ' ORD-FIGI ' Not found' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-FIGI ,  value of String literal (' Not found') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SECURITY-INACTIVE</div>	<div class="cfq">when 88-SECURITY-INACTIVE</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE ORD-TRADEID TO WS-TRADEID</div>	<div class="cfq">copy variable ORD-TRADEID to variable WS-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : SECURITY ' ORD-FIGI ' Not Active' DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of variable ORD-FIGI ,  value of String literal (' Not Active') and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SECURITY-EXCEPTION</div>	<div class="cfq">when 88-SECURITY-EXCEPTION</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-SECURITY-ERROR-MSG TO WS-EXCEPTION</div>	<div class="cfq">copy variable WS-SECURITY-ERROR-MSG to variable WS-EXCEPTION</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">IF 88-SECURITY-ACTIVE THEN</div>	<div class="cfq">If condition (88-SECURITY-ACTIVE) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET OVERDUE-SECURITY-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SECURITY-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div></div></div><div id="content5" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the paragraph 5003-BUYER-SEC-ACCOUNT processes a buyer's security account based on the provided buyer ID and currency. Initially, it moves the buyer ID and currency into designated variables. It then executes a SQL SELECT statement to retrieve the security account number and status from the TBTRDSAC table. The SQL execution result is evaluated through the SQLCODE. If the account is active (SQLCODE = 0 and SAC-STATUS = 'A'), it displays relevant account information. If the account is inactive or not found (SQLCODE = 0 with SAC-STATUS not 'A' or SQLCODE = 100), it sets an exception flag, logs an error message, and updates the order status accordingly. For any other SQL errors, it also sets an application exception and logs the error. The code ensures proper handling of buyer security account validations and updates order details as necessary.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; SAC-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; SAC-NUMBER</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-ACC-DISP</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-SEC-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-BUYER-AC-INVLD</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SAC-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; SAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SAC-NUMBER</div>	</div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-ID TO SAC-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-BUYER-ID to variable SAC-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;SAC_NUMBER , SAC_STATUS <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;SAC_CUSTOMER_ID   = :SAC-CUSTOMER-ID AND   SAC_CURRENCY      = :SAC-CURRENCY WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDSAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">IF SAC-STATUS = 'A'</div>	<div class="cfq">If condition (SAC-STATUS = 'A') is true, then do the following: </div><div class="explain">	<div class="bold-content">DISPLAY SAC-CUSTOMER-ID '**' SAC-CURRENCY '**' SAC-NUMBER</div>	<div class="cfq">log a message by concatenating the following : variable SAC-CUSTOMER-ID &  String literal ('**') &  variable SAC-CURRENCY &  String literal ('**') &  variable SAC-NUMBER</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO TRD-BUYER-SEC-ACC-NUM</div>	<div class="cfq">copy variable SAC-NUMBER to variable TRD-BUYER-SEC-ACC-NUM</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Buyer Security Account' ' Not active - SAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not active - SAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-BUYER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-BUYER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Buyer Security Account' ' Not Found  - SAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not Found  - SAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-BUYER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-BUYER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Buyer Security Account' ' Select Failed - SQLCODE  = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Buyer Security Account') ,  value of String literal (' Select Failed - SQLCODE  = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div><div id="content6" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the paragraph 5004-SELLER-SEC-ACCOUNT processes seller security account information based on a trade order. It begins by transferring the seller ID and currency from trade variables to corresponding account variables. A SQL SELECT statement retrieves the account number and status from the TBTRDSAC table, checking for the specified customer ID and currency. The SQL execution result is evaluated through the SQLCODE variable.If the SQLCODE is 0, indicating success, it checks if the account status is active ('A'). If active, it assigns the account number to a trade variable. If not active or if the account is not found (SQLCODE 100), it sets an exception flag, logs an error message, and updates the order status accordingly. Any other SQL errors also trigger exception handling. The code ensures proper handling of exceptions and updates the order based on the account status.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&rarr; SAC-STATUS</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; SAC-NUMBER</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-ACC-DISP</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-SEC-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SELLER-AC-INVLD</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; SAC-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; SAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SAC-NUMBER</div>	</div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-ID TO SAC-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-SELLER-ID to variable SAC-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;SAC_NUMBER , SAC_STATUS <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;SAC_CUSTOMER_ID   = :SAC-CUSTOMER-ID AND   SAC_CURRENCY      = :SAC-CURRENCY WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDSAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">IF SAC-STATUS = 'A'</div>	<div class="cfq">If condition (SAC-STATUS = 'A') is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO TRD-SELLER-SEC-ACC-NUM</div>	<div class="cfq">copy variable SAC-NUMBER to variable TRD-SELLER-SEC-ACC-NUM</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Security Account' ' Not active - SAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not active - SAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Security Account' ' Not Found  - SAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not Found  - SAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable SAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Seller Security Account' ' Select Failed - SQLCODE  = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Seller Security Account') ,  value of String literal (' Select Failed - SQLCODE  = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div><div id="content7" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the paragraph 5005-BUYER-MONEY-ACCOUNT processes a buyer's money account based on a trade order. It begins by transferring the trade currency and buyer ID to corresponding account variables. A SQL SELECT statement retrieves the account number and status from the TBTRDMAC table, checking for active accounts. The SQL execution result is evaluated through the SQLCODE. If the account is active (SQLCODE = 0 and MAC-STATUS = 'A'), the account number is assigned to the trade buyer's money account. If inactive or not found (SQLCODE = 100), it sets an exception flag, logs the issue, and updates the order status accordingly. For any other SQL errors, it also logs the failure. The code ensures proper handling of exceptions and updates the order based on the account status, maintaining data integrity throughout the process.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; MAC-STATUS</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-ACC-DISP</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-BUYER-AC-INVLD</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; MAC-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; MAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>	</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO MAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable MAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-ID TO MAC-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-BUYER-ID to variable MAC-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;MAC_NUMBER , MAC_STATUS <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDMAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;MAC_CURRENCY      = :MAC-CURRENCY AND MAC_CUSTOMER_ID   = :MAC-CUSTOMER-ID WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDMAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">IF MAC-STATUS = 'A'</div>	<div class="cfq">If condition (MAC-STATUS = 'A') is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO TRD-BUYER-MONEY-ACC-NUM</div>	<div class="cfq">copy variable MAC-NUMBER to variable TRD-BUYER-MONEY-ACC-NUM</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Buyer Money Account' ' Not active - MAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not active - MAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-BUYER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-BUYER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Buyer Money Account' ' Not Found  - MAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not Found  - MAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-BUYER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-BUYER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Buyer Money Account' ' Select Failed - SQLCODE  = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Buyer Money Account') ,  value of String literal (' Select Failed - SQLCODE  = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div><div id="content8" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the paragraph 5006-SELLER-MONEY-ACCOUNT processes a seller's money account based on a trade transaction. It begins by transferring the trade currency and seller ID to corresponding account variables. A SQL SELECT statement retrieves the account number and status from the TBTRDMAC table, checking for active accounts. If the SQL execution is successful (SQLCODE = 0) and the account status is active ('A'), it assigns the account number to the trade seller's money account number. If the account is inactive or not found (SQLCODE = 100), it sets an exception flag, logs the issue, and updates the order status accordingly. Any other SQL errors also trigger exception handling. The code ensures that the order is updated based on the account's validity, maintaining data integrity throughout the process.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; WS-TRADEID</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; MAC-STATUS</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-ACC-DISP</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; MAC-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; OVERDUE-SELLER-AC-INVLD</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; MAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>        			<div class="cfqs">&emsp;&larr; DATA-EXCEPTION</div>	</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO MAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable MAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-ID TO MAC-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-SELLER-ID to variable MAC-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;MAC_NUMBER , MAC_STATUS <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDMAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;MAC_CURRENCY      = :MAC-CURRENCY AND MAC_CUSTOMER_ID   = :MAC-CUSTOMER-ID WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDMAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div><div class="explain">	<div class="bold-content">IF MAC-STATUS = 'A'</div>	<div class="cfq">If condition (MAC-STATUS = 'A') is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO TRD-SELLER-MONEY-ACC-NUM</div>	<div class="cfq">copy variable MAC-NUMBER to variable TRD-SELLER-MONEY-ACC-NUM</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Money Account' ' Not active - MAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not active - MAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN 100</div>	<div class="cfq">when 100</div><div class="explain">	<div class="bold-content">SET DATA-EXCEPTION TO TRUE</div>	<div class="cfq">set variable DATA-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'TradeId = ' WS-TRADEID ' : ' 'Rejected - Reason : Seller Money Account' ' Not Found  - MAC Numnber  = ' WS-ACC-DISP DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('TradeId = ') ,  value of variable WS-TRADEID ,  value of String literal (' ) ,  value of String literal ('Rejected - Reason ) ,  value of String literal (' Not Found  - MAC Numnber  = ') ,  value of variable WS-ACC-DISP and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">SET OVERDUE-SELLER-AC-INVLD TO TRUE</div>	<div class="cfq">set variable OVERDUE-SELLER-AC-INVLD to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE MAC-NUMBER TO WS-ACC-DISP</div>	<div class="cfq">copy variable MAC-NUMBER to variable WS-ACC-DISP</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Seller Money Account' ' Select Failed - SQLCODE  = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Seller Money Account') ,  value of String literal (' Select Failed - SQLCODE  = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div><div id="content9" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5007-UPDATE-ORDER-MATCHED is responsible for updating order details when an order is accepted. It begins by setting a flag, MATCHED, to TRUE, indicating that the order has been matched. The code then transfers various trading-related data from working storage variables (WS-ORDER-STATUS, TRD-CURRENCY, TRD-EXCHANGE, TRD-ORDER-ID, TRD-FIGI) to corresponding order variables (ORD-STATUS, ORD-CURRENCY, ORD-TRADING-XCHNG, ORD-TRADEID, ORD-FIGI). Next, it sets the order's buy/sell indicator (ORD-BUY-SELL-IND) to 'B' (for buy) and calls the subroutine 8000-UPDATE-ORDER to process this order. Afterward, it changes the buy/sell indicator to 'S' (for sell) and performs the update again. This sequence ensures that both buy and sell aspects of the order are processed correctly.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 1</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&rarr; TRD-EXCHANGE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-ID</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; ORD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; ORD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; TRD-EXCHANGE</div>        			<div class="cfqs">&emsp;&larr; MATCHED</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; ORD-BUY-SELL-IND</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADEID</div>        			<div class="cfqs">&emsp;&larr; TRD-FIGI</div>        			<div class="cfqs">&emsp;&larr; ORD-TRADING-XCHNG</div>	</div><div class="explain">	<div class="bold-content">SET MATCHED TO TRUE</div>	<div class="cfq">set variable MATCHED to true</div></div><div class="explain">	<div class="bold-content">MOVE WS-ORDER-STATUS TO ORD-STATUS</div>	<div class="cfq">copy variable WS-ORDER-STATUS to variable ORD-STATUS</div></div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO ORD-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable ORD-CURRENCY</div></div><div class="explain">	<div class="bold-content">MOVE TRD-EXCHANGE TO ORD-TRADING-XCHNG</div>	<div class="cfq">copy variable TRD-EXCHANGE to variable ORD-TRADING-XCHNG</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-ID TO ORD-TRADEID</div>	<div class="cfq">copy variable TRD-ORDER-ID to variable ORD-TRADEID</div></div><div class="explain">	<div class="bold-content">MOVE TRD-FIGI TO ORD-FIGI</div>	<div class="cfq">copy variable TRD-FIGI to variable ORD-FIGI</div></div><div class="explain">	<div class="bold-content">MOVE 'B' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'B'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div><div class="explain">	<div class="bold-content">MOVE 'S' TO ORD-BUY-SELL-IND</div>	<div class="cfq">initialize variable ORD-BUY-SELL-IND with 'S'</div></div><div class="explain">	<div class="bold-content">PERFORM 8000-UPDATE-ORDER THRU 8000-EXIT</div>	<div class="cfq">execute paragraph 8000-UPDATE-ORDER</div></div></div><div id="content10" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5008-WRITE-TO-STLMT-QUEUE is responsible for managing a trading order queue. It begins by incrementing the index variable `WS-STQ-INDEX` by 1, which tracks the number of entries in the queue. The current trading order, represented by `TRD-ORDER-PAIR`, is then copied into an array `WS-STQ-TRDPAIR` at the position indicated by the updated index. A message displaying the trading order is logged for tracking purposes. If the index reaches 100, indicating that the queue is full, the code executes the `5009-INSERT-TO-STQ` paragraph to process the queue and resets the index back to 0. This ensures that the system can handle a maximum of 100 trading orders before needing to process them, maintaining efficient order management.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 2</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-STQ-INDEX</div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-PAIR</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-STQ-INDEX</div>        			<div class="cfqs">&emsp;&larr; WS-STQ-TRDPAIR</div>        			<div class="cfqs">&emsp;&larr; TRD-ORDER-PAIR</div>	</div><div class="explain">	<div class="bold-content">ADD 1 TO WS-STQ-INDEX</div>	<div class="cfq">increment variable WS-STQ-INDEX by 1</div></div><div class="explain">	<div class="bold-content">MOVE TRD-ORDER-PAIR TO WS-STQ-TRDPAIR ( WS-STQ-INDEX )</div>	<div class="cfq">copy variable TRD-ORDER-PAIR to array WS-STQ-TRDPAIR</div></div><div class="explain">	<div class="bold-content">DISPLAY '(' TRD-ORDER-PAIR ')'</div>	<div class="cfq">log a message by concatenating the following : String literal ('(') &  variable TRD-ORDER-PAIR &  String literal (')')</div></div><div class="explain">	<div class="bold-content">IF WS-STQ-INDEX = 100 THEN</div>	<div class="cfq">If condition (WS-STQ-INDEX = 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">PERFORM 5009-INSERT-TO-STQ THRU 5009-EXIT</div>	<div class="cfq">execute paragraph 5009-INSERT-TO-STQ</div></div><div class="explain">	<div class="bold-content">MOVE 0 TO WS-STQ-INDEX</div>	<div class="cfq">initialize variable WS-STQ-INDEX with 0</div></div></div></div><div id="content11" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 5009-INSERT-TO-STQ is responsible for inserting data into the TBTRDSTQ table. It executes an SQL INSERT statement that adds values for currency and trade data, using variables WS-STQ-CURRENCY and WS-STQ-TRDPAIR for a specified number of rows indicated by WS-STQ-INDEX. The operation is designed to continue even if an SQL exception occurs. After the insert attempt, the code evaluates the SQLCODE to determine the outcome. If the SQLCODE is 0, the operation is successful. For any other SQLCODE, it captures the error code in WS-SQLCODE, sets an application exception flag, and initializes WS-EXCEPTION with a descriptive error message. Finally, it calls the 9000-REPORT-EXCEPTION paragraph to handle the error reporting. This structure ensures robust error handling during database operations.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 5</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>        			<div class="cfqs">&emsp;&rarr; 5008-WRITE-TO-STLMT-QUEUE</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>	</div><div class="explain">	<div class="bold-content">INSERT INTO INTO <br>&nbsp;&nbsp;&nbsp;TBTRDSTQ ( STQ_CURRENCY ,STQ_TRADE_DATA ) <br>VALUES <br>&nbsp;&nbsp;&nbsp;( :WS-STQ-CURRENCY ,:WS-STQ-TRDPAIR ) FOR :WS-STQ-INDEX ROWS <br>NOT ATOMIC ATOMIC <br>&nbsp;&nbsp;&nbsp;CONTINUE ON SQLEXCEPTION </div>	<div class="cfq">execute a sql INSERT statement using cursor INSERT </div></div><div class="explain">	<div class="bold-content">EVALUATE SQLCODE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 0</div>	<div class="cfq">when 0</div></div><div class="explain">	<div class="bold-content">WHEN OTHER</div>	<div class="cfq">when anything else</div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Settlement Queue Insert Failed with SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Settlement Queue Insert Failed with SQLCODE = ') ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div><div id="content12" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 8000-UPDATE-ORDER is responsible for updating the status of an order in a trading system. It begins by setting a flag to indicate that a SQL operation will be performed and initializes the SQL error code to zero. The code then executes an SQL UPDATE statement to modify the order status based on specific criteria, including currency, trading exchange, trade ID, and buy/sell indicator.If the SQL operation encounters a deadlock or timeout (indicated by SQLCODE -911 or -913), it sets a retry flag. If any other SQL error occurs, it captures the error code, sets an exception flag, and logs an error message. Additionally, if the order is overdue, it initializes a customer summary record and determines whether to log the buyer or seller's information based on the order type. Overall, this code manages order updates and handles potential errors effectively.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 9</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 5004-SELLER-SEC-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5005-BUYER-MONEY-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5006-SELLER-MONEY-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5007-UPDATE-ORDER-MATCHED</div>        			<div class="cfqs">&emsp;&rarr; 5000-GET-SELL-SIDE-ORDER</div>        			<div class="cfqs">&emsp;&rarr; 5003-BUYER-SEC-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5001-VALIDATE-CUSTOMERS</div>        			<div class="cfqs">&emsp;&rarr; 5002-VALIDATE-SECURITY</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&rarr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; ORD-BUY-SELL-IND</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-DEBIT-CREDIT-SW</div>        			<div class="cfqs">&emsp;&larr; SQL-DONE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-ID</div>        			<div class="cfqs">&emsp;&larr; OVERDUE</div>        			<div class="cfqs">&emsp;&larr; ORD-STATUS</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-RETRY-SWITCH</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; 88-SUMMARY-NO-BOOKING</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; LK-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; DO-SQL</div>        			<div class="cfqs">&emsp;&larr; RETRY-SQL</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-REC</div>	</div><div class="explain">	<div class="bold-content">SET DO-SQL TO TRUE</div>	<div class="cfq">set variable DO-SQL to true</div></div><div class="explain">	<div class="bold-content">MOVE 0 TO SQLCODE</div>	<div class="cfq">initialize variable SQLCODE with 0</div></div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDORD <br>SET <br>&nbsp;&nbsp;&nbsp;ORD_STATUS = :ORD-STATUS <br>WHERE <br>&nbsp;&nbsp;&nbsp;ORD_CURRENCY      = :ORD-CURRENCY AND   ORD_TRADING_XCHNG = :ORD-TRADING-XCHNG AND   ORD_TRADEID       = :ORD-TRADEID AND   ORD_FIGI          = :ORD-FIGI AND   ORD_BUY_SELL_IND  = :ORD-BUY-SELL-IND </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = -911 OR -913 THEN</div>	<div class="cfq">If condition (SQLCODE = -911 OR -913) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET RETRY-SQL TO TRUE</div>	<div class="cfq">set variable RETRY-SQL to true</div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET SQL-DONE TO TRUE</div>	<div class="cfq">set variable SQL-DONE to true</div></div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Update of Order failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Update of Order failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">MOVE ORD-STATUS TO WS-ORDER-STATUS</div>	<div class="cfq">copy variable ORD-STATUS to variable WS-ORDER-STATUS</div></div><div class="explain">	<div class="bold-content">IF OVERDUE</div>	<div class="cfq">If condition (OVERDUE) is true, then do the following: </div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq">initialize the variable WS-CUSTOMER-SUMMARY-REC with its default value</div></div><div class="explain">	<div class="bold-content">INITIALIZE WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq"></div></div><div class="explain">	<div class="bold-content">SET 88-SUMMARY-NO-BOOKING TO TRUE</div>	<div class="cfq">set variable 88-SUMMARY-NO-BOOKING to true</div></div><div class="explain">	<div class="bold-content">IF ORD-BUY-SELL-IND = 'B' THEN</div>	<div class="cfq">If condition (ORD-BUY-SELL-IND = 'B') is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-ID TO WS-SUMMARY-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-BUYER-ID to variable WS-SUMMARY-CUSTOMER-ID</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-ID TO WS-SUMMARY-CUSTOMER-ID</div>	<div class="cfq">copy variable TRD-SELLER-ID to variable WS-SUMMARY-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">MOVE LK-CURRENCY TO WS-SUMMARY-CURRENCY</div>	<div class="cfq">copy variable LK-CURRENCY to variable WS-SUMMARY-CURRENCY</div></div><div class="explain">	<div class="bold-content">PERFORM 8001-LOG-SUMMARY THRU 8001-EXIT</div>	<div class="cfq">execute paragraph 8001-LOG-SUMMARY</div></div></div></div></div></div><div id="content13" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code snippet in the paragraph 9000-REPORT-EXCEPTION is designed to handle exceptions within a program. It begins by copying the content of the variable `WS-EXCEPTION` into `EXCEPTION-DESC`, which serves as a description of the exception. The length of this exception description is then stored in `EXCEPTION-RECORD-LEN`. The code evaluates the type of exception encountered: if it is a system, application, or data exception, it assigns the corresponding type to `EXCEPTION-TYPE`. Regardless of the type, it increments the `EXCEPTION-RECORD-LEN` by 46 to account for additional information. Finally, it calls an exception handler program (`WS-EXCEPTION-HANDLER`), passing the updated length and the exception record for further processing. This structured approach ensures that exceptions are categorized and handled appropriately, enhancing the robustness of the application.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 4</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 1000-ORDER-ACCEPTANCE</div>        			<div class="cfqs">&emsp;&rarr; 5004-SELLER-SEC-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 0000-MAINLINE</div>        			<div class="cfqs">&emsp;&rarr; 8000-UPDATE-ORDER</div>        			<div class="cfqs">&emsp;&rarr; 5005-BUYER-MONEY-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 8001-LOG-SUMMARY</div>        			<div class="cfqs">&emsp;&rarr; 5006-SELLER-MONEY-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5000-GET-SELL-SIDE-ORDER</div>        			<div class="cfqs">&emsp;&rarr; 5003-BUYER-SEC-ACCOUNT</div>        			<div class="cfqs">&emsp;&rarr; 5001-VALIDATE-CUSTOMERS</div>        			<div class="cfqs">&emsp;&rarr; 5009-INSERT-TO-STQ</div>        			<div class="cfqs">&emsp;&rarr; 5002-VALIDATE-SECURITY</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; SYSTEM-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; DATA-EXCEPTION</div>        			<div class="cfqs">&emsp;&rarr; WS-EXCP-TYPE</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-TYPE</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-RECORD-LEN</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; EXCEPTION-DESC</div>	</div><div class="explain">	<div class="bold-content">MOVE WS-EXCEPTION TO EXCEPTION-DESC</div>	<div class="cfq">copy variable WS-EXCEPTION to variable EXCEPTION-DESC</div></div><div class="explain">	<div class="bold-content">MOVE LENGTH OF WS-EXCEPTION TO EXCEPTION-RECORD-LEN</div>	<div class="cfq">copy function (null) to variable EXCEPTION-RECORD-LEN</div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN SYSTEM-EXCEPTION</div>	<div class="cfq">when SYSTEM-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'SYSTEM' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'SYSTEM'</div></div></div><div class="explain">	<div class="bold-content">WHEN APPL-EXCEPTION</div>	<div class="cfq">when APPL-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'APPLICATION' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'APPLICATION'</div></div></div><div class="explain">	<div class="bold-content">WHEN DATA-EXCEPTION</div>	<div class="cfq">when DATA-EXCEPTION</div><div class="explain">	<div class="bold-content">MOVE 'DATA' TO EXCEPTION-TYPE</div>	<div class="cfq">initialize variable EXCEPTION-TYPE with 'DATA'</div></div></div><div class="explain">	<div class="bold-content">ADD 46 TO EXCEPTION-RECORD-LEN</div>	<div class="cfq">increment variable EXCEPTION-RECORD-LEN by 46</div></div><div class="explain">	<div class="bold-content">CALL WS-EXCEPTION-HANDLER USING EXCEPTION-RECORD-LEN , EXCEPTION-RECORD</div>	<div class="cfq">invoke a program using variable WS-EXCEPTION-HANDLER, the actual program name is 'TRDPBEXC' using parameters variable EXCEPTION-RECORD-LEN-GROUP,variable EXCEPTION-RECORD</div></div></div></div><div id="content14" class="content-item"><div class="llm">	<div class="explain">		<strong> The COBOL code in the 8001-LOG-SUMMARY paragraph processes customer summary data from the TBTRDSUM table. It begins by moving a customer ID into a working variable and attempts to select relevant summary fields for updating. If the SQL operation fails, it logs the error and exits. Upon successful fetch, it checks the SQL code to determine if data exists. If no data is found (SQLCODE 100), it initializes summary fields to zero. If data is present, it updates or inserts summary records based on transaction types (debit, credit, or no booking). The code also handles balance calculations and increments summary counters for overdue, rejected, and settled transactions. Finally, it ensures proper error handling for SQL operations, including closing the cursor and reporting exceptions as necessary. Overall, this code manages customer transaction summaries while maintaining robust error handling and data integrity.</strong>	</div></div>	<div class="explain">		<div class="para">Cyclomatic Complexity:</div>		<div class="cfqs">&emsp; 30</div>		<div class="para">Entry from           : </div>        			<div class="cfqs">&emsp;&rarr; 8000-UPDATE-ORDER</div>		<div class="para">Input to this Paragraph     : </div>        			<div class="cfqs">&emsp;&rarr; WS-SUMMARY-DEBIT-CREDIT-SW</div>        			<div class="cfqs">&emsp;&rarr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&rarr; REJECTED</div>        			<div class="cfqs">&emsp;&rarr; TRD-SELLER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&rarr; MAC-BALANCE</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&rarr; OVERDUE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-DONE</div>        			<div class="cfqs">&emsp;&rarr; DCLTBTRDSUM</div>        			<div class="cfqs">&emsp;&rarr; TRD-ORDER-AMOUNT</div>        			<div class="cfqs">&emsp;&rarr; WS-ORDER-STATUS</div>        			<div class="cfqs">&emsp;&rarr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-NO-BOOKING</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-CREDIT</div>        			<div class="cfqs">&emsp;&rarr; SETTLED</div>        			<div class="cfqs">&emsp;&rarr; TRD-BUYER-ID</div>        			<div class="cfqs">&emsp;&rarr; SQLCODE</div>        			<div class="cfqs">&emsp;&rarr; SQL-INIT-FLAG</div>        			<div class="cfqs">&emsp;&rarr; 88-SUMMARY-DEBIT</div>        <div class="para">Modified In this Paragraph   : </div>        			<div class="cfqs">&emsp;&larr; SUM-CLOSE-BALANCE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SUM-SETTLED</div>        			<div class="cfqs">&emsp;&larr; DCLTBTRDSUM</div>        			<div class="cfqs">&emsp;&larr; WS-SUMMARY-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; SUM-CUSTOMER-ID</div>        			<div class="cfqs">&emsp;&larr; APPL-EXCEPTION</div>        			<div class="cfqs">&emsp;&larr; SQLCODE</div>        			<div class="cfqs">&emsp;&larr; WS-EXCP-TYPE</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-REC</div>        			<div class="cfqs">&emsp;&larr; SUM-OVERDUE</div>        			<div class="cfqs">&emsp;&larr; TRD-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-SUMMARY-WRITE</div>        			<div class="cfqs">&emsp;&larr; TRD-SELLER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; MAC-NUMBER</div>        			<div class="cfqs">&emsp;&larr; TRD-BUYER-MONEY-ACC-NUM</div>        			<div class="cfqs">&emsp;&larr; SUM-TOTAL-CREDIT</div>        			<div class="cfqs">&emsp;&larr; RETURN-CODE</div>        			<div class="cfqs">&emsp;&larr; SUM-TOTAL-DEBIT</div>        			<div class="cfqs">&emsp;&larr; SUM-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; WS-SQLCODE</div>        			<div class="cfqs">&emsp;&larr; MAC-CURRENCY</div>        			<div class="cfqs">&emsp;&larr; 88-CUSTOMER-SUMMARY-REWRITE</div>        			<div class="cfqs">&emsp;&larr; SUM-REJECTED</div>        			<div class="cfqs">&emsp;&larr; SUM-OPEN-BALANCE</div>        			<div class="cfqs">&emsp;&larr; WS-CUSTOMER-SUMMARY-WRITE-SW</div>	</div><div class="explain">	<div class="bold-content">MOVE WS-SUMMARY-CUSTOMER-ID TO SUM-CUSTOMER-ID</div>	<div class="cfq">copy variable WS-SUMMARY-CUSTOMER-ID to variable SUM-CUSTOMER-ID</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID ,SUM_OVERDUE ,SUM_REJECTED ,SUM_SETTLED ,SUM_CURRENCY ,SUM_OPEN_BALANCE ,SUM_TOTAL_DEBIT ,SUM_TOTAL_CREDIT ,SUM_CLOSE_BALANCE <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>WHERE <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID = :SUM-CUSTOMER-ID FOR <br>UPDATE <br>&nbsp;&nbsp;&nbsp;OF SUM_OVERDUE ,SUM_REJECTED ,SUM_SETTLED ,SUM_CURRENCY ,SUM_OPEN_BALANCE ,SUM_TOTAL_DEBIT ,SUM_TOTAL_CREDIT ,SUM_CLOSE_BALANCE </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDSUM table </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor OPEN Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor OPEN Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div><div class="explain">	<div class="bold-content">FETCH <br>&nbsp;&nbsp;&nbsp;SUMMARY_CSR <br>INTO <br>&nbsp;&nbsp;&nbsp;:SUM-CUSTOMER-ID ,:SUM-OVERDUE ,:SUM-REJECTED ,:SUM-SETTLED ,:SUM-CURRENCY ,:SUM-OPEN-BALANCE ,:SUM-TOTAL-DEBIT ,:SUM-TOTAL-CREDIT ,:SUM-CLOSE-BALANCE </div>	<div class="cfq">execute a sql FETCH statement using cursor SUMMARY_CSR </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 OR 100 THEN</div>	<div class="cfq">If condition (SQLCODE = 0 OR 100) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor OPEN Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor OPEN Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 100 THEN</div>	<div class="cfq">If condition (SQLCODE = 100) is true, then do the following: </div><div class="explain">	<div class="bold-content">SET 88-CUSTOMER-SUMMARY-WRITE TO TRUE</div>	<div class="cfq">set variable 88-CUSTOMER-SUMMARY-WRITE to true</div></div><div class="explain">	<div class="bold-content">MOVE ZERO TO SUM-OVERDUE SUM-REJECTED SUM-SETTLED SUM-CURRENCY SUM-OPEN-BALANCE SUM-TOTAL-DEBIT SUM-TOTAL-CREDIT SUM-CLOSE-BALANCE</div>	<div class="cfq">initialize variable SUM-OVERDUE & variable SUM-REJECTED & variable SUM-SETTLED & variable SUM-CURRENCY & variable SUM-OPEN-BALANCE & variable SUM-TOTAL-DEBIT & variable SUM-TOTAL-CREDIT & variable SUM-CLOSE-BALANCE with ZERO</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">SET 88-CUSTOMER-SUMMARY-REWRITE TO TRUE</div>	<div class="cfq">set variable 88-CUSTOMER-SUMMARY-REWRITE to true</div></div><div class="explain">	<div class="bold-content">MOVE DCLTBTRDSUM TO WS-CUSTOMER-SUMMARY-REC</div>	<div class="cfq">copy variable DCLTBTRDSUM to variable WS-CUSTOMER-SUMMARY-REC</div></div><div class="explain">	<div class="bold-content">IF ( 88-SUMMARY-DEBIT OR 88-SUMMARY-CREDIT ) AND SUM-OPEN-BALANCE = 0 THEN</div>	<div class="cfq">If condition (( 88-SUMMARY-DEBIT OR 88-SUMMARY-CREDIT ) AND SUM-OPEN-BALANCE = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO MAC-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable MAC-CURRENCY</div></div><div class="explain">	<div class="bold-content">IF TRD-BUYER-ID = SUM-CUSTOMER-ID</div>	<div class="cfq">If condition (TRD-BUYER-ID = SUM-CUSTOMER-ID) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-BUYER-MONEY-ACC-NUM TO MAC-NUMBER</div>	<div class="cfq">copy variable TRD-BUYER-MONEY-ACC-NUM to variable MAC-NUMBER</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE TRD-SELLER-MONEY-ACC-NUM TO MAC-NUMBER</div>	<div class="cfq">copy variable TRD-SELLER-MONEY-ACC-NUM to variable MAC-NUMBER</div></div><div class="explain">	<div class="bold-content">SELECT <br>&nbsp;&nbsp;&nbsp; MAC_BALANCE <br>FROM <br>&nbsp;&nbsp;&nbsp;TBTRDMAC <br>WHERE <br>&nbsp;&nbsp;&nbsp;MAC_CURRENCY   = :MAC-CURRENCY AND MAC_NUMBER     = :MAC-NUMBER WITH UR </div>	<div class="cfq">execute a sql SELECT statement from the TBTRDMAC table  with read data that may not yet be committed by other transactions </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 THEN</div>	<div class="cfq">If condition (SQLCODE = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">IF TRD-BUYER-ID = SUM-CUSTOMER-ID</div>	<div class="cfq">If condition (TRD-BUYER-ID = SUM-CUSTOMER-ID) is true, then do the following: </div><div class="explain">	<div class="bold-content">COMPUTE SUM-OPEN-BALANCE = MAC-BALANCE + TRD-ORDER-AMOUNT</div>	<div class="cfq">computes the expression "variable MAC-BALANCE + variable TRD-ORDER-AMOUNT  and stores the final result into variable SUM-OPEN-BALANCE</div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">COMPUTE SUM-OPEN-BALANCE = MAC-BALANCE - TRD-ORDER-AMOUNT</div>	<div class="cfq">computes the expression "variable MAC-BALANCE - variable TRD-ORDER-AMOUNT  and stores the final result into variable SUM-OPEN-BALANCE</div></div><div class="explain">	<div class="bold-content">MOVE SUM-OPEN-BALANCE TO SUM-CLOSE-BALANCE</div>	<div class="cfq">copy variable SUM-OPEN-BALANCE to variable SUM-CLOSE-BALANCE</div></div></div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN OVERDUE</div>	<div class="cfq">when OVERDUE</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-OVERDUE</div>	<div class="cfq">increment variable SUM-OVERDUE by 1</div></div></div><div class="explain">	<div class="bold-content">WHEN REJECTED</div>	<div class="cfq">when REJECTED</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-REJECTED</div>	<div class="cfq">increment variable SUM-REJECTED by 1</div></div></div><div class="explain">	<div class="bold-content">WHEN SETTLED</div>	<div class="cfq">when SETTLED</div><div class="explain">	<div class="bold-content">ADD 1 TO SUM-SETTLED</div>	<div class="cfq">increment variable SUM-SETTLED by 1</div></div></div><div class="explain">	<div class="bold-content">EVALUATE TRUE</div>	<div class="cfq">Evaluate conditions listed below: </div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-DEBIT</div>	<div class="cfq">when 88-SUMMARY-DEBIT</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SUM-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SUM-CURRENCY</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-TOTAL-DEBIT</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-TOTAL-DEBIT</div></div><div class="explain">	<div class="bold-content">SUBTRACT TRD-ORDER-AMOUNT FROM SUM-CLOSE-BALANCE</div>	<div class="cfq">subtract variable TRD-ORDER-AMOUNT from variable SUM-CLOSE-BALANCE</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-CREDIT</div>	<div class="cfq">when 88-SUMMARY-CREDIT</div><div class="explain">	<div class="bold-content">MOVE TRD-CURRENCY TO SUM-CURRENCY</div>	<div class="cfq">copy variable TRD-CURRENCY to variable SUM-CURRENCY</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-TOTAL-CREDIT</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-TOTAL-CREDIT</div></div><div class="explain">	<div class="bold-content">ADD TRD-ORDER-AMOUNT TO SUM-CLOSE-BALANCE</div>	<div class="cfq">add variable TRD-ORDER-AMOUNT to variable SUM-CLOSE-BALANCE</div></div></div><div class="explain">	<div class="bold-content">WHEN 88-SUMMARY-NO-BOOKING</div>	<div class="cfq">when 88-SUMMARY-NO-BOOKING</div></div><div class="explain">	<div class="bold-content">IF 88-CUSTOMER-SUMMARY-WRITE</div>	<div class="cfq">If condition (88-CUSTOMER-SUMMARY-WRITE) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE WS-CUSTOMER-SUMMARY-REC TO DCLTBTRDSUM</div>	<div class="cfq">copy variable WS-CUSTOMER-SUMMARY-REC to variable DCLTBTRDSUM</div></div><div class="explain">	<div class="bold-content">INSERT INTO INTO <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>VALUES <br>&nbsp;&nbsp;&nbsp;( :SUM-CUSTOMER-ID ,:SUM-OVERDUE ,:SUM-REJECTED ,:SUM-SETTLED ,:SUM-CURRENCY ,:SUM-OPEN-BALANCE ,:SUM-TOTAL-DEBIT ,:SUM-TOTAL-CREDIT ,:SUM-CLOSE-BALANCE ) </div>	<div class="cfq">execute a sql INSERT statement using cursor INSERT </div></div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">UPDATE <br>&nbsp;&nbsp;&nbsp;TBTRDSUM <br>SET <br>&nbsp;&nbsp;&nbsp;SUM_OVERDUE       = :SUM-OVERDUE ,SUM_REJECTED      = :SUM-REJECTED ,SUM_SETTLED       = :SUM-SETTLED ,SUM_CURRENCY      = :SUM-CURRENCY ,SUM_OPEN_BALANCE  = :SUM-OPEN-BALANCE ,SUM_TOTAL_DEBIT   = :SUM-TOTAL-DEBIT ,SUM_TOTAL_CREDIT  = :SUM-TOTAL-CREDIT ,SUM_CLOSE_BALANCE = :SUM-CLOSE-BALANCE <br>WHERE <br>&nbsp;&nbsp;&nbsp;SUM_CUSTOMER_ID = :SUM-CUSTOMER-ID </div>	<div class="cfq">execute a sql UPDATE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE = 0 THEN</div>	<div class="cfq">If condition (SQLCODE = 0) is true, then do nothing </div></div><div class="explain">	<div class="bold-content">ELSE</div>	<div class="cfq">Else do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Insert/Update Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Insert/Update Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div><div class="explain">	<div class="bold-content">CLOSE SUMMARY_CSR </div>	<div class="cfq">execute a sql CLOSE statement </div></div><div class="explain">	<div class="bold-content">IF SQLCODE NOT = 0 THEN</div>	<div class="cfq">If condition (SQLCODE NOT = 0) is true, then do the following: </div><div class="explain">	<div class="bold-content">MOVE SQLCODE TO WS-SQLCODE</div>	<div class="cfq">copy variable SQLCODE to variable WS-SQLCODE</div></div><div class="explain">	<div class="bold-content">SET APPL-EXCEPTION TO TRUE</div>	<div class="cfq">set variable APPL-EXCEPTION to true</div></div><div class="explain">	<div class="bold-content">MOVE SPACES TO WS-EXCEPTION</div>	<div class="cfq">initialize variable WS-EXCEPTION with SPACE</div></div><div class="explain">	<div class="bold-content">STRING 'Summary Cursor CLOSE Failed : SQLCODE = ' WS-SQLCODE DELIMITED BY SIZE INTO WS-EXCEPTION END-STRING</div>	<div class="cfq">Concatenates  value of String literal ('Summary Cursor CLOSE Failed ) ,  value of variable WS-SQLCODE and stores the final result into variable WS-EXCEPTION.</div></div><div class="explain">	<div class="bold-content">PERFORM 9000-REPORT-EXCEPTION THRU 9000-EXIT</div>	<div class="cfq">execute paragraph 9000-REPORT-EXCEPTION</div></div></div></div></div></div></div></div></div></div></div></div>		</div>    </div>        </div>	<script>        function showContent(contentId, button) {            document.getElementById('content').scrollTop = 0;			var contentItems = document.querySelectorAll('.content-item');			contentItems.forEach(function (item) {			item.classList.remove('active');			});			var sidebarButtons = document.querySelectorAll('.sidebar button');			sidebarButtons.forEach(function (btn) {				btn.classList.remove('active');			});			var activeContent = document.getElementById(contentId);			if (activeContent) {					activeContent.classList.add('active');				}			if (button) {				button.classList.add('active');			}		}		window.onload = function () {			var defaultButton = document.querySelector('.sidebar button');			if (defaultButton) {				defaultButton.classList.add('active');				showContent('contentProcDiv', defaultButton);			}		}		</script>				<!-- smart-doc footer -->    </body></html>